/**
 * JavaScript for PHPMaker 12
 * @license (C)2002-2015 e.World Technology Ltd.
 */function ew_DefaultLookup(e,t){var n=t.data,r=t.parents;for(var i=0,s=r.length;i<s;i++){var o=r[i];if(!o.length)return t.valid=!1;var u=n[5+i];if(!jQuery.isUndefined(u)&&ew_InArray(u,o)<0)return t.valid=!1}}function ew_InitIcons(){var e=jQuery;e(".ewIcon").closest("a, button").add(".ewTooltip").tooltip({container:"body",trigger:typeof EW_IS_MOBILE!="undefined"&&EW_IS_MOBILE?"manual":"hover",placement:"bottom"})}function ew_InitPasswordOptions(){var e=jQuery,t=function(e){return ewLanguage.Phrase("CurrentPassword")+e};e.fn.pStrength&&typeof EW_MIN_PASSWORD_STRENGTH!="undefined"&&e(".ewPasswordStrength").not("[data-password-strength*='$rowindex$']").pStrength({changeBackground:!1,backgrounds:[],passwordValidFrom:EW_MIN_PASSWORD_STRENGTH,onPasswordStrengthChanged:function(t,n){var r=e(this),i=e("#"+r.data("password-strength")),s=i.find(".progress-bar");if(r.val()){var o=n+"%";n<25?s.addClass("progress-bar-danger").removeClass("progress-bar-warning progress-bar-info progress-bar-success"):n<50?s.addClass("progress-bar-warning").removeClass("progress-bar-danger progress-bar-info progress-bar-success"):n<75?s.addClass("progress-bar-info").removeClass("progress-bar-danger progress-bar-warning progress-bar-success"):s.addClass("progress-bar-success").removeClass("progress-bar-danger progress-bar-warning progress-bar-info"),s.css("width",o),n>25&&(o=ewLanguage.Phrase("PasswordStrength").replace("%p",o)),s.html(o),i.show(),r.data("validated",n>=EW_MIN_PASSWORD_STRENGTH)}else i.hide(),r.data("validated",!1)}}).on("keyup change",function(){var n=e(this),r=e("#"+n.data("password-generated"));r.is(":visible")&&(r.toggle(!!n.val()),r.html(t(n.val())))}),e.fn.pGenerator&&e(".ewPasswordGenerator").not("[data-password-field*='$rowindex$']").each(function(){var n=e(this);n.pGenerator({passwordElement:"#"+n.data("password-field"),displayElement:"#"+n.data("password-confirm"),passwordLength:EW_GENERATE_PASSWORD_LENGTH,uppercase:EW_GENERATE_PASSWORD_UPPERCASE,lowercase:EW_GENERATE_PASSWORD_LOWERCASE,numbers:EW_GENERATE_PASSWORD_NUMBER,specialChars:EW_GENERATE_PASSWORD_SPECIALCHARS,onPasswordGenerated:function(r){e("#"+n.data("password-field")).change().focus().triggerHandler("click"),e("#"+n.data("password-strength")).hide(),e("#"+n.data("password-generated")).html(t(r)).show()}})})}function ew_SetSessionTimer(){if(typeof EW_IS_LOGGEDIN=="undefined"||!EW_IS_LOGGEDIN)return;var e=jQuery,t,n,r,i,s,o=e("#ewTimer"),u=(EW_SESSION_KEEP_ALIVE_INTERVAL>0||EW_IS_AUTOLOGIN)&&EW_SESSION_URL,a=function(){var t=EW_SESSION_URL+"?rnd="+ew_Random();e.get(t,function(t){EW_TOKEN=t,e("input:hidden[name=token]").val(t)})};o.find(".modal-footer .btn-primary").click(function(e){r&&r.cancel(),o.modal("hide"),a(),!u&&EW_SESSION_TIMEOUT>0&&c()});var f=function(){s=EW_SESSION_TIMEOUT_COUNTDOWN,t=EW_SESSION_TIMEOUT-EW_SESSION_TIMEOUT_COUNTDOWN,t<0&&(t=0,s=EW_SESSION_TIMEOUT),r&&r.cancel(),n&&n.cancel()},l=function(){i&&i.cancel(),r=e.later(1e3,null,function(){s>0?(o.find(".modal-body").html('<p class="text-danger">'+ewLanguage.Phrase("SessionWillExpire").replace("%s",s)+"</p>"),o.modal("show")):(o.find(".modal-body").html('<p class="text-danger">'+ewLanguage.Phrase("SessionExpired")+"</p>"),f(),e.later(1e3,null,function(){o.modal("hide"),window.location=EW_LOGOUT_URL+"?expired=1"})),s--},null,!0)},c=function(){f(),n=e.later(t*1e3,null,l)};if(u){var h=EW_SESSION_KEEP_ALIVE_INTERVAL>0?EW_SESSION_KEEP_ALIVE_INTERVAL:EW_SESSION_TIMEOUT-EW_SESSION_TIMEOUT_COUNTDOWN;h<=0&&(h=60),i=e.later(h*1e3,null,a,null,!0)}else EW_SESSION_TIMEOUT>0&&c()}function ew_Form(e,t){var n=jQuery;this.ID=e,this.PageID=t,this.$Element=null,this.Form=null,this.InitSearchPanel=!1,this.Modified=!1,this.SrchOprChanged=function(e){var t=this.GetForm(),r=n(t),i=n.isString(e)?t.elements[e]:e;if(!i)return;var s=i.id.substr(2),o=n(i).val(),u=o=="BETWEEN",a=o=="IS NULL"||o=="IS NOT NULL";/^z_/.test(i.id)&&r.find("[name^=x_"+s+"],[name^=cal_x_"+s+"]").prop("disabled",a),/^w_/.test(i.id)&&r.find("[name^=y_"+s+"],[name^=cal_y_"+s+"]").prop("disabled",a),r.find("span.btw0_"+s).toggle(!u).end().find("span.btw1_"+s).toggle(u).find(":input").prop("disabled",!u)},this.ValidateRequired=!0,this.Validate=null,this.DisableForm=function(){if(!EW_DISABLE_BUTTON_ON_SUBMIT)return;var e=this.GetForm();n(e).find(":submit:not(.dropdown-toggle)").prop("disabled",!0).addClass("disabled")},this.EnableForm=function(){if(!EW_DISABLE_BUTTON_ON_SUBMIT)return;var e=this.GetForm();n(e).find(":submit:not(.dropdown-toggle)").prop("disabled",!1).removeClass("disabled")},this.Submit=function(e){var t=this.GetForm(),r=n(t);this.DisableForm(),this.UpdateTextArea(),this.PostAutoSuggest();if(!this.Validate||this.Validate()&&!r.find(".has-error")[0]){e&&(t.action=e),r.find("input[name^=s_],input[name^=sv_],input[name^=q_],.ewTemplate input").prop("disabled",!0);var i=n(r.find("input[name='detailpage']").map(function(e,t){return r.find("#"+t.value).get()}));i.length>1&&i.each(function(e,t){n(t).find(":input").each(function(e,s){if(/^(fn_)?(x|o)\d*_/.test(s.name)){var o=i.not(t).find(":input[name='"+s.name+"']");if(o.length){var u=n(s).serializeArray();n.each(u,function(e,i){n("<input type='hidden' name='"+t.id+"$"+s.name+"'>").val(i.value).appendTo(r)})}}})}),t.submit()}else this.EnableForm();return!1},this.EmptyRow=null,this.MultiPage=null,this.Lists=function(e){return e=e.replace(/^[xy](\d*|\$rowindex\$)_/,"x_"),this.Lists[e]},this.CompileTemplates=function(){for(var e in this.Lists){var t=this.Lists[e];t.Template&&n.isString(t.Template)&&(t.Template=n.templates(t.Template))}},this.AutoSuggests={},this.GetForm=function(){return this.Form||(this.$Element=n("#"+this.ID),this.$Element.is("form")?this.Form=this.$Element[0]:this.$Element.is("div")&&(this.Form=this.$Element.closest("form")[0])),this.Form},this.GetElement=function(e){return this.$Element||(this.$Element=n("#"+this.ID)),e?ew_GetElement(e,this.$Element):this.$Element[0]},this.GetElements=function(e){this.$Element||(this.$Element=n("#"+this.ID));var t="[name='"+e+"']";t="input"+t+",select"+t+",textarea"+t+",button"+t;var r=this.$Element.find(t);return r.length==0?null:r.length==1&&r.is(":not(:checkbox):not(:radio)")?r[0]:r.get()},this.PostAutoSuggest=function(){for(var e in this.AutoSuggests){var t=this.AutoSuggests[e].$input;if(t&&t.is(":focus")){t.blur();break}}},this.UpdateOpts=function(e){if(e===$rowindex$)return;var t=[],r=this.GetForm();this.CompileTemplates();for(var i in this.Lists){var s=this.Lists[i].ParentFields.slice(),o=this.Lists[i].Ajax;if(n.isValue(e)){i=i.replace(/^x_/,"x"+e+"_");for(var u=0,a=s.length;u<a;u++)s[u]=s[u].replace(/^x_/,"x"+e+"_")}if(n.isBoolean(o)){var f=[];for(var u=0,a=s.length;u<a;u++)f[f.length]=ew_GetOptValues(s[u],r);t[t.length]=[i,f,o,!1]}else ew_UpdateOpt.call(this,i,s,null,!1)}var l=10;for(var u=0,c=t.length;u<c;u++)n.later(l*u,this,ew_UpdateOpt,t[u])},this.CreateAutoSuggest=function(e){e.form=this,n(function(){e.form.AutoSuggests[e.id]=new ew_AutoSuggest(e)})},this.CreateEditor=function(e){var t=this.GetForm();n(t.elements).filter("textarea.editor").each(function(t,r){var i=n(r).data("editor");if(!i||i.active||i.name.indexOf("$rowindex$")>-1||e&&i.name!=e)return!0;i.create();if(e)return!1})},this.UpdateTextArea=function(e){var t=this.GetForm();n(t.elements).filter("textarea.editor").each(function(t,r){var i=n(r).data("editor");if(!i||e&&i.name!=e)return!0;i.save();if(e)return!1})},this.DestroyEditor=function(e){var t=this.GetForm();n(t.elements).filter("textarea.editor").each(function(t,r){var i=n(r).data("editor");if(!i||e&&i.name!=e)return!0;i.destroy();if(e)return!1})},this.OnError=function(e,t){return ew_OnError(this,e,t)},this.InitUpload=function(){var e=this.GetForm();n(e.elements).filter("input:file").each(ew_Upload)},this.SetupFilters=function(e,t){var r=this.ID,i=this.FilterList,s=n(".ewSaveFilter[data-form="+r+"]"),o=n(".ewDeleteFilter[data-form="+r+"]"),u=o.parent("li").toggleClass("dropdown-submenu",!!t.length).toggleClass("disabled",!t.length),a=s.parent("li").toggleClass("disabled",!i),f=n(e.target);a.off("click.ew").on("click.ew",function(e){ew_Prompt(ewLanguage.Phrase("EnterFilterName"),function(e){t[t.length]=[e,i],n.localStorage.set(r+"_filters",t)},!0)}).prevAll().remove(),o.next("ul.dropdown-menu").remove();if(t.length){$menu=o.closest("ul.dropdown-menu"),$submenu=n("<ul class='dropdown-menu'></ul>");for(var l in t){if(!n.isArray(t[l]))continue;n("<li><a data-index='"+l+"' href='#'>"+t[l][0]+"</a></li>").on("click",function(e){var i=n(this).find("a[data-index]").data("index");ew_Prompt(ewLanguage.Phrase("DeleteFilterConfirm").replace("%s",t[i][0]),function(){delete t[i],n.localStorage.set(r+"_filters",t)})}).appendTo($submenu),n("<li><a class='ewFilterList' data-index='"+l+"' href='#'>"+t[l][0]+"</a></li>").insertBefore(a).on("click",function(e){var r=n(this).find("a[data-index]").data("index");n("<form>").attr({method:"post",action:ew_CurrentPage()}).append(n("<input type='hidden'>").attr({name:"cmd",value:"resetfilter"}),n("<input type='hidden'>").attr({name:"token",value:EW_TOKEN}),n("<input type='hidden'>").attr({name:"filter",value:JSON.stringify(t[r][1])})).appendTo("body").submit()})}n("<li class='divider'></li>").insertBefore(a),u.append($submenu)}},this.Init=function(){var e=this,t=this.GetForm(),r=n(t);window.localStorage?n(".ewFilterOption."+this.ID+" .ewButtonDropdown").on("show.bs.dropdown",function(t){var r=n.localStorage.get(e.ID+"_filters")||[],i=n.grep(r,function(e){if(n.isArray(e)&&e.length==2)return e});e.SetupFilters(t,i)}):n(".ewFilterOption").hide();if(!t)return;this.CompileTemplates();var i=/s(ea)?rch$/.test(this.ID);i&&this.InitSearchPanel&&!ew_HasFormData(t)&&n("#"+this.ID+"_SearchPanel").removeClass("in"),n(".ewSearchToggle[data-form="+this.ID+"]").on("click.bs.button",function(){n("#"+n(this).data("form")+"_SearchPanel").collapse("toggle")}),n(".ewTable .ewSearchOperator").text().trim()||n(".ewTable .ewSearchOperator").parent("td").hide(),i&&n(".ewHighlight[data-form="+this.ID+"]").on("click.bs.button",function(){n("span."+n(this).data("name")).toggleClass("ewHighlightSearch")}),i&&r.find("select[id^=z_]").each(function(){var e=n(this).change();e.val()!="BETWEEN"&&r.find("#w_"+this.id.substr(2)).change()}),this.MultiPage&&this.MultiPage.Render(),this.CreateEditor(),this.UpdateOpts(),this.InitUpload(),this.$Element.is("form")&&(r.submit(function(t){return e.Submit()}),r.find("[data-field], .ewPriv").change(function(){EW_CONFIRM_CANCEL&&(e.Modified=!0)}),r.find("#btnCancel[data-href]").click(function(){e.UpdateTextArea(),e.PostAutoSuggest();var r=n(this).data("href");e.Modified&&ew_HasFormData(t)?ew_Prompt(ewLanguage.Phrase("ConfirmCancel"),function(e){e&&(window.location=r)}):window.location=r})),this.$Element.data("form",this)},ewForms[this.ID]=this}function ew_Prompt(e,t,n){var r=jQuery,i=r("#ewPrompt"),s=i.find(".modal-body").empty();n?(s.append('<div class="form-group"><label class="control-label">'+e+"</label>"+'<input type="text" class="form-control" style="display: block; width: 100%;"></div>'),$input=s.find("input").click(function(){$input.parent().removeClass("has-error")}),i.find(".modal-footer .btn-primary").off().click(function(e){var n=r.trim($input.val());n==""?($input.parent().addClass("has-error"),$input[0].focus()):(i.modal("hide"),r.isFunction(t)&&t(n))}),i.on("shown.bs.modal",function(e){$input[0].focus()})):(s.append("<div>"+e+"</div>"),i.find(".modal-footer .btn-primary").off().click(function(e){i.modal("hide"),r.isFunction(t)&&t(!0)}),t?i.find(".modal-footer .btn-default").off().click(function(e){i.modal("hide"),r.isFunction(t)&&t(!1)}).show():i.find(".modal-footer .btn-default").hide()),i.modal("show")}function ew_GetForm(e){var t=jQuery,n=t(e),r=n.closest(".ewForm");return r[0]||(r=n.closest(".ewGrid,.ewMultiColumnGrid").find(".ewForm")),r[0]}function ew_HasFormData(e){var t=jQuery,n="[name^=x_][value!='{value}'],[name^=y_],[name^=z_],[name^=w_],[name=psearch]",r=t(e).find(n).filter(":enabled").get();for(var i=0,s=r.length;i<s;i++){var o=r[i];if(/^(z|w)_/.test(o.name)){if(/^IS/.test(t(o).val()))return!0}else if(o.type=="checkbox"||o.type=="radio"){if(o.checked)return!0}else if(o.type=="select-one"||o.type=="select-multiple"){if(!!t(o).val())return!0}else if(o.type=="text"||o.type=="hidden"||o.type=="textarea")if(o.value)return!0}return!1}function ew_SetSearchType(e,t){var n=jQuery,r=n(e),i=r.closest("form"),s="";return i.find("input[name=psearchtype]").val(t||""),t=="="?s=ewLanguage.Phrase("QuickSearchExactShort"):t=="AND"?s=ewLanguage.Phrase("QuickSearchAllShort"):t=="OR"?s=ewLanguage.Phrase("QuickSearchAnyShort"):s=ewLanguage.Phrase("QuickSearchAutoShort"),i.find("#searchtype").html(s+(s?"&nbsp;":"")),r.closest("ul").find("li").removeClass("active"),r.closest("li").addClass("active"),!1}function ew_UpdateOpt(e,t,n,r){var i=jQuery,s=this,o=i(this),u=function(){o.queue().length?o.dequeue():i(document).trigger("updatedone",[{source:s,target:e}])},a=this.$Element?this.$Element[0]:this.form?this.form:null;if(!a)return u();var f=this.Form?this:ewForms[a.id];if(!f)return u();var l=i.makeArray(arguments);this.form&&i.isUndefined(e)&&(e=ewForms(this).Lists[this.name.replace(/^[xy]\d*_/,"x_")].ChildFields.slice());if(!e||i.isArray(e)&&e.length==0)return u();if(i.isArray(e)&&i.isString(e[0])){for(var c=0,h=e.length;c<h;c++){var p=e[c].split(" ");if(p.length==1&&s.form){var d=ew_GetId(s,!1).match(/^([xy]\d*_)/);d&&(e[c]=e[c].replace(/^([xy]\d*_)/,d[1]))}var v=ew_GetElements(e[c],a),m=[];if(p.length==2&&i.isArray(v)){var g=i(v);g.each(function(){if(ew_InArray(this.name,m)==-1){m[m.length]=this.name;var e=g.filter("[name='"+this.name+"']"),u=e.attr("type");u=="radio"||u=="checkbox"?o.queue(i.proxy(ew_UpdateOpt,s,e.get(),t,n,r)):o.queue(i.proxy(ew_UpdateOpt,s,e[0],t,n,r))}})}else o.queue(i.proxy(ew_UpdateOpt,s,v,t,n,r))}var y=ewForms(this).Lists[this.name.replace(/^[xy]\d*_/,"x_")];return y&&y.AutoFill&&o.queue(function(){ew_AutoFill(s)}),u()}i.isString(e)&&(e=ew_GetElements(e,a));if(!e||i.isArray(e)&&e.length==0)return u();var p=ew_GetOptValues(e),b=ew_GetId(e,!1);if(!b)return u();var w="",E="",d=b.match(/^([xy])(\d*)_/);d&&(w=d[1],E=d[2]);var S=b.replace(/^([xy])(\d*)_/,"x_"),x=[],T=ew_GetForm(e);if(!T||!T.id)return u();var N=ewForms[T.id];if(!N)return u();if(i.isUndefined(t)){t=N.Lists[S].ParentFields.slice();if(E!="")for(var c=0,h=t.length;c<h;c++){var p=t[c].split(" ");p.length==1&&(t[c]=t[c].replace(/^x_/,"x"+E+"_"))}else w=="y"}if(i.isArray(t)&&t.length>0)if(i.isArray(t[0]))x=t;else if(i.isString(t[0]))for(var c=0,h=t.length;c<h;c++){var p=t[c].split(" ");p.length==2?x[x.length]=ew_GetOptValues(t[c]):p.length==1&&(x[x.length]=ew_GetOptValues(t[c],a))}ew_IsAutoSuggest(e)||ew_ClearOpt(e);var C=function(t){for(var n=0,s=t.length;n<s;n++){var o={data:t[n],parents:x,valid:!0,name:ew_GetId(e),form:T};i(document).trigger("addoption",[o]),o.valid&&ew_NewOpt(e,t[n],T)}!e.options&&e.length&&(ew_RenderOpt(e),e=ew_GetElements(b,T)),ew_SelectOpt(e,p),r!==!1&&(!e.options&&e.length?i(e).first().triggerHandler("click"):i(e).first().change())};i.isUndefined(n)&&(n=N.Lists[S].Ajax);if(!i.isBoolean(n)){var k=N.Lists[S].Options;return C(k),/s(ea)?rch$/.test(a.id)&&w=="x"&&(l[0]=b.replace(/^x_/,"y_"),ew_UpdateOpt.apply(this,l)),u()}var L=ew_GetId(e),A=i(T).find("#s_"+L).val();if(!A)return u();A+="&ajax=updateoption&name="+L,ew_IsAutoSuggest(e)&&this.Form&&(A+="&v0="+(p[0]?encodeURIComponent(p[0]):ew_Random()));for(var c=0,O=x.length;c<O;c++)A+="&v"+(c+1)+"="+encodeURIComponent(x[c].join(","));A+="&token="+EW_TOKEN,i.ajax(EW_LOOKUP_FILE_NAME,{type:"POST",dataType:"json",data:A,async:n,success:function(e){C(e||[])}}).always(function(){u()}),/s(ea)?rch$/.test(a.id)&&w=="x"&&(l[0]=b.replace(/^x_/,"y_"),ew_UpdateOpt.apply(this,l))}function ew_Language(e){this.obj=e,this.Phrase=function(e){return this.obj[e.toLowerCase()]}}function ew_ApplyTemplate(e,t,n,r,i){var s=jQuery,o=s("#"+t);if(!s.views||!o[0])return;o.attr("type")||o.attr("type","text/html");var u={data:i||{},id:e,template:t,filename:n,"export":r,enabled:!0};s(document).trigger("rendertemplate",[u]),u.enabled&&s("#"+e).html(o.render(u.data)),r&&r!="print"&&s(function(){var t=s("meta[http-equiv='Content-Type']"),n="<html><head>",i=s("#"+e);t[0]&&(n+="<meta http-equiv='Content-Type' content='"+t.attr("content")+"'>"),r=="pdf"?(n+="<link rel='stylesheet' type='text/css' href='"+EW_PDF_STYLESHEET_FILENAME+"'>",i.children(0).is("div[id^=ct_]")&&(i=i.children(0))):n+="<style>"+s.ajax({async:!1,type:"GET",url:EW_PROJECT_STYLESHEET_FILENAME}).responseText+"</style>",n+="</head><body>"+i.html()+"</body></html>";var o=ew_CurrentPage();if(r=="email"){var a=window.location.search.replace(/^\?/,"")+"&"+s.param({customexport:r,data:n,filename:u.filename});a+="&token="+EW_TOKEN,s.post(o,a,function(e){ew_ShowMessage(e)})}else s("<form>").attr({method:"post",action:o}).append(s("<input type='hidden'>").attr({name:"customexport",value:r}),s("<input type='hidden'>").attr({name:"data",value:n}),s("<input type='hidden'>").attr({name:"filename",value:u.filename})).appendTo("body").submit();window.location!=window.parent.location&&window.parent.jQuery&&window.parent.jQuery("body").css("cursor","default")})}function ew_RenderTemplate(e){var t=jQuery,n=t("#"+e);if(!t.views||!n[0])return;n.attr("type")||n.attr("type","text/html");var r={data:{},template:e};return t(document).trigger("rendertemplate",[r]),n.render(r.data)}function ew_ShowTemplates(e){var t=jQuery;t("script"+(e?"."+e:"")+"[type='text/html']").each(function(){$scr=t(this),/^\s*(<td[\s\S]*>[\s\S]*<\/td>)\s*$/i.test($scr.html())?$scr.next().before(t("<table><tr>"+RegExp.$1+"</tr></table>").find("tr:first > td")):t(this).after(t("<span></span>").addClass($scr.attr("class")).html($scr.html())),$scr.closest(".ewTable").show(),$scr.closest(".ewGrid").show()})}function ew_ConvertToBool(e){return e&&ew_InArray(e.toLowerCase(),["1","y","t"])>-1}function ew_ValueChanged(e,t,n,r){var i=jQuery,s=ew_GetElements("x"+t+"_"+n,e),o=ew_GetElement("o"+t+"_"+n,e),u=ew_GetElement("fn_x"+t+"_"+n,e);if(!o&&(!s||i.isArray(s)&&s.length==0))return!1;var a=function(e){return ew_GetOptValues(e).join(",")};if(o&&s)if(r){if(ew_ConvertToBool(a(o))===ew_ConvertToBool(a(s)))return!1}else{var f=a(o),l=u?a(u):a(s);if(f==l)return!1}return!0}function ew_ReadOnlyTextArea(e,t,n){if(!e||!e.parentNode)return;var r=jQuery,i=r(e).hide().prop("readOnly",!0),s=r("<div></div>").addClass("ewReadOnlyTextArea").width(t).height(n).appendTo(i.parent()),o=r("<div></div>").addClass("ewResizeHandle").appendTo(s),u=r("<div></div>").html(i.val()).addClass("ewReadOnlyTextAreaData uneditable-textarea").appendTo(s);u.height(s.height()-5),s.drag("start",function(e,t){t.width=r(this).width(),t.height=r(this).height()}).drag(function(e,t){r(this).css({width:Math.max(20,t.width+t.deltaX),height:Math.max(20,t.height+t.deltaY)}),u.height(s.height()-5)},{handle:".ewResizeHandle"})}function ew_Get(e,t){t=t||window.location.search;var n=/(?:\?|&)([^&=]+)=?([^&]*)/g,r=/\+/g,i=function(e){return decodeURIComponent(e.replace(r," "))},s={},o;while(o=n.exec(t)){var u=i(o[1]),a=i(o[2]);u.substring(u.length-2)==="[]"&&(u=u.substring(0,u.length-2)),(s[u]||(s[u]=[])).push(a)}return s[e]}function ew_SetLanguage(e){var t=jQuery,n=t(e),r=n.val()||n.data("language");if(!r)return;var i=window.location.href;if(window.location.search){var s=window.location.search,o={};s.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g,function(e,t,n){t&&(o[t]=n)}),o.language=encodeURIComponent(r);var u="?";for(var a in o)u+=a+"="+o[a]+"&";u=u.substr(0,u.length-1);var f=i.lastIndexOf(window.location.search);i=i.substr(0,f)+u}else i+="?language="+encodeURIComponent(r);window.location=i}function ew_SubmitAction(e,t){var n=jQuery,r=e.target||e.srcElement,i=n(r),s=t.f||i.closest("form")[0]||CurrentForm,o=n(s),u=t.key,a=t.action,f=t.url||ew_CurrentPage(),l=t.msg,c=t.data,h=t.success,p=!t.method||ew_SameText(t.method[0],"p"),d=!t.select&&!t.key||t.select&&ew_SameText(t.select[0],"m");if(d&&!o[0])return;if(d&&!ew_KeySelected(o[0])){ew_Prompt('<p class="text-danger">'+ewLanguage.Phrase("NoRecordSelected")+"</p>");return}var v=function(){if(p){a&&n("<input>").attr({type:"hidden",name:"useraction",value:a}).appendTo(o);if(n.isObject(c))for(var e in c)n("<input>").attr({type:"hidden",name:e,value:c[e]}).appendTo(o);if(!d&&n.isObject(u))for(var e in u)n("<input>").attr({type:"hidden",name:e,value:u[e]}).appendTo(o);o.prop("action",f).submit()}else c=n.isObject(c)?n.param(c):n.isString(c)?c:"",c+=(c?"&":"")+"token="+EW_TOKEN,a&&(c+="&useraction="+a+"&ajax="+a),d?c+="&"+o.find("input[name='key_m[]']:checked").serialize():u&&(c+="&"+(n.isObject(u)?n.param(u):u)),n.post(f,c,h||function(e){ew_ShowMessage(e)})};l?ew_Prompt(l,function(e){e&&v()}):v()}function ew_Export(e,t,n,r,i,s){if(!e)return;var o=jQuery,u=o(e),a=u.attr("target"),f=u.attr("action"),l=i&&u.find("input:checkbox[name='key_m[]']")[0];if(l&&!ew_KeySelected(e)){ew_Alert(ewLanguage.Phrase("NoRecordSelected"));return}if(r){o("iframe.ewExport").remove(),n=="email"&&(t+=("&"+o(s).serialize()).replace(/&export=email/i,""));if(l){o("<iframe>").attr("name","ewExportFrame").addClass("ewExport hide").appendTo(o("body").css("cursor","wait"));try{u.append(o("<input type='hidden'>").attr({name:"custom",value:"1"})).attr({action:t,target:"ewExportFrame"}).find("input[name=exporttype]").val(n).end().submit()}finally{u.attr({target:a||"",action:f}).find("input[name=custom]").remove()}}else o("<iframe>").attr({name:"ewExportFrame",src:t}).addClass("ewExport hide").appendTo(o("body").css("cursor","wait"));o.later(5e3,null,function(){o("body").css("cursor","default")})}else u.find("input[name=exporttype]").val(n).end().submit()}function ew_RemoveSpaces(e){return/^(<(p|br)\/?>(&nbsp;)?(<\/p>)?)?$/i.test(e.replace(/\s/g,""))?"":e}function ew_IsHiddenTextArea(e){var t=jQuery,n=t(e);return e&&n.is(":hidden")&&n.data("editor")}function ew_IsAutoSuggest(e){var t=jQuery,n=t(e);return e&&n.is(":hidden")&&n.data("autosuggest")}function ew_GetAutoSuggest(e){return ewForms(e).AutoSuggests[e.id]}function ew_Alert(e,t,n){var r=jQuery;if(EW_IS_MOBILE)alert(e),t&&r.later(100,null,t);else{var i=r("#ewMsgBox");i.find(".modal-body").html('<p class="text-'+(n||"danger")+'">'+e+"</p>"),i.modal("show"),t&&i.off("hidden.bs.modal").on("hidden.bs.modal",t)}}function ew_OnError(e,t,n){if(t.jquery){var r=t.attr("type");t=r=="checkbox"||r=="radio"?t.get():t[0]}ew_Alert(n,function(){ew_SetFocus(t)});if(e)if(e.MultiPage)e.MultiPage.GotoPageByElement(t);else if(e.$Element.is("div")){var i=e.$Element.closest(".tab-pane");i[0]&&!i.hasClass("active")&&i.closest(".tabbable").find("a[data-toggle=tab][href='#"+i.attr("id")+"']").click()}return!1}function ew_SetFocus(e){if(!e)return;var t=jQuery,n=t(e);if(ew_IsHiddenTextArea(e))return n.data("editor").focus();!e.options&&e.length?e=n.filter("[value!='{value}']")[0]:ew_IsAutoSuggest(e)&&(e=ew_GetAutoSuggest(e).input);var r=n.closest(".form-group,[id^='el_']").addClass("has-error");n.focus().select().one("click keypress",function(){r.removeClass("has-error")})}function ew_HasValue(e){return ew_GetOptValues(e).join("")!=""}function ew_Sort(e,t,n){return n==2&&e.ctrlKey&&(t+="&ctrl=1"),location=t,!0}function ew_ConfirmDelete(e){return ew_ClickDelete(e),ew_Prompt(ewLanguage.Phrase("DeleteConfirmMsg"),function(t){t&&e.href?window.location=e.href:ew_ClearDelete(e)}),!1}function ew_KeySelected(e){return jQuery(e).find("input:checkbox[name='key_m[]']:checked",e).length>0}function ew_SelectAllKey(e){ew_SelectAll(e);var t=jQuery,n=t(e).closest("."+EW_TABLE_CLASSNAME)[0];if(!n)return;t(n.tBodies).each(function(){t(this.rows).each(function(n,r){var i=t(r);i.is(":not(."+EW_ITEM_TEMPLATE_CLASSNAME+"):not(."+EW_TABLE_PREVIEW_ROW_CLASSNAME+")")&&(i.data({selected:e.checked,checked:e.checked}),ew_SetColor(n,r))})})}function ew_SelectAll(e){if(!e||!e.form)return;$(e.form.elements).filter("input:checkbox[name^="+e.name+"_], :checkbox[name="+e.name+"]").not(e).prop("checked",e.checked)}function ew_UpdateSelected(e){return jQuery(e).find("input:checkbox[name^=u_]:checked").length>0}function ew_AddClass(e,t){var n=jQuery,r=n(e);r.data("bgcolor")||r.data("bgcolor",r.css("backgroundColor")),r.data("color")||r.data("color",r.css("color")),r.css("backgroundColor","").css("color","").addClass(t)}function ew_RemoveClass(e,t){var n=jQuery,r=n(e).removeClass(t);r.data("bgcolor")&&r.css("backgroundColor",r.data("bgcolor")),r.data("color")&&r.css("color",r.data("color"))}function ew_UpdateRow(e,t){var n=jQuery,r=n(e),i=r.data("rowindex");if(!e||!n.isFunction(t))return;t(-1,e),i&&(r.prevUntil("tr[data-rowindex!='"+i+"']").each(t),r.nextUntil("tr[data-rowindex!='"+i+"']").each(t))}function ew_MouseOver(e){var t=jQuery,n=t(this);if(!n.data("selected")&&ew_InArray(n.data("rowtype"),[EW_ROWTYPE_ADD,EW_ROWTYPE_EDIT])==-1){var r=n.closest("."+EW_TABLE_CLASSNAME);if(!r[0])return;ew_UpdateRow(this,function(e,n){t(n).addClass(r.data("rowhighlightclass")||EW_TABLE_HIGHLIGHT_ROW_CLASSNAME)})}}function ew_MouseOut(e){var t=jQuery,n=t(this);!n.data("selected")&&ew_InArray(n.data("rowtype"),[EW_ROWTYPE_ADD,EW_ROWTYPE_EDIT])==-1&&ew_UpdateRow(this,ew_SetColor)}function ew_Click(e){var t=jQuery,n=t(this),r=n.closest("."+EW_TABLE_CLASSNAME)[0],i=t(e.target);if(!r||i.hasClass("btn")||i.hasClass("ewPreviewRowBtn")||i.is(":input"))return;if(!n.data("checked")){var s=n.data("selected");ew_ClearSelected(r),ew_UpdateRow(this,function(e,n){t(n).data("selected",!s),ew_SetColor(e,n)})}}function ew_SetColor(e,t){var n=jQuery,r=n(t),i=r.closest("."+EW_TABLE_CLASSNAME);if(!i[0])return;r.data("selected")?r.removeClass(i.data("rowhighlightclass")||EW_TABLE_HIGHLIGHT_ROW_CLASSNAME).removeClass(i.data("roweditclass")||EW_TABLE_EDIT_ROW_CLASSNAME).addClass(i.data("rowselectclass")||EW_TABLE_SELECT_ROW_CLASSNAME):ew_InArray(r.data("rowtype"),[EW_ROWTYPE_ADD,EW_ROWTYPE_EDIT])>-1?r.removeClass(i.data("rowselectclass")||EW_TABLE_SELECT_ROW_CLASSNAME).removeClass(i.data("rowhighlightclass")||EW_TABLE_HIGHLIGHT_ROW_CLASSNAME).addClass(i.data("roweditclass")||EW_TABLE_EDIT_ROW_CLASSNAME):r.removeClass(i.data("rowselectclass")||EW_TABLE_SELECT_ROW_CLASSNAME).removeClass(i.data("roweditclass")||EW_TABLE_EDIT_ROW_CLASSNAME).removeClass(i.data("rowhighlightclass")||EW_TABLE_HIGHLIGHT_ROW_CLASSNAME)}function ew_ClearSelected(e){var t=jQuery;t(e.rows).each(function(e,n){var r=t(n);!r.data("checked")&&r.data("selected")&&(r.data("selected",!1),ew_SetColor(e,n))})}function ew_ClearDelete(e){var t=jQuery,n=t(e),r=n.closest("."+EW_TABLE_CLASSNAME)[0];if(!r)return;ew_UpdateRow(n.closest(".ewTable > tbody > tr")[0],function(e,n){var r=t(n);r.data("selected",r.data("checked"))})}function ew_ClickDelete(e){var t=jQuery,n=t(e),r=n.closest("."+EW_TABLE_CLASSNAME)[0];if(!r)return;ew_ClearSelected(r),ew_UpdateRow(n.closest(".ewTable > tbody > tr")[0],function(e,n){t(n).data("selected",!0),ew_SetColor(e,n)})}function ew_StopPropagation(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function ew_ClickMultiCheckbox(e){var t=jQuery,n=e.target||e.srcElement,r=t(n),i=r.closest("."+EW_TABLE_CLASSNAME)[0];if(!i)return;ew_ClearSelected(i),ew_UpdateRow(r.closest(".ewTable > tbody > tr")[0],function(e,r){t(r).data("checked",n.checked).data("selected",n.checked).find("input:checkbox[name='key_m[]']").each(function(){this!=n&&(this.checked=n.checked)}),ew_SetColor(e,r)}),ew_StopPropagation(e)}function ew_SetupTable(e,t,n){var r=jQuery,i=r(t),s=r(t.rows);if(!t||!t.rows||!n&&i.data("isset")||t.tBodies.length==0)return;var o=s.filter("[data-rowindex=1]").length||s.filter("[data-rowindex=0]").length||1,u=s.filter(":not(."+EW_ITEM_TEMPLATE_CLASSNAME+"):not(:hidden)").each(function(){r(this.cells).removeClass(EW_TABLE_LAST_ROW_CLASSNAME).last().addClass(EW_TABLE_LAST_COL_CLASSNAME)}).get(),a=i.parentsUntil(".ewGrid",".table-responsive")[0];if(u.length)for(var f=1;f<=o;f++){var l=u[u.length-f];r(l.cells).each(function(){this.rowSpan==f&&r(this).addClass(EW_TABLE_LAST_ROW_CLASSNAME).toggleClass(EW_TABLE_BORDER_BOTTOM_CLASSNAME,!!a&&a.clientHeight>t.offsetHeight)})}var c=i.closest("form")[0],h=c&&r(c.elements).filter("input#a_list:not([value^=grid])").length>0;r(t.tBodies[t.tBodies.length-1].rows).filter(":not(."+EW_ITEM_TEMPLATE_CLASSNAME+"):not(."+EW_TABLE_PREVIEW_ROW_CLASSNAME+")").each(function(e){var t=r(this);h&&!t.data("isset")&&(ew_InArray(t.data("rowtype"),[EW_ROWTYPE_ADD,EW_ROWTYPE_EDIT])>-1&&t.on("mouseover",function(){this.edit=!0}).addClass(EW_TABLE_EDIT_ROW_CLASSNAME),t.on("mouseover",ew_MouseOver).on("mouseout",ew_MouseOut).on("click",ew_Click),t.data("isset",!0));var n=e%(2*o)<o;t.toggleClass(EW_TABLE_ROW_CLASSNAME,n).toggleClass(EW_TABLE_ALT_ROW_CLASSNAME,!n)}),ew_SetupGrid(e,i.closest("."+EW_GRID_CLASSNAME)[0],n),i.data("isset",!0)}function ew_SetupGrid(e,t,n){var r=jQuery,i=r(t);if(!t||!n&&i.data("isset"))return;var s=i.find("table.ewMultiColumnTable").length,o;s?o=i.find("td[data-rowindex]").length:o=i.find("table."+EW_TABLE_CLASSNAME+" > tbody:first > tr:not(."+EW_TABLE_PREVIEW_ROW_CLASSNAME+", ."+EW_ITEM_TEMPLATE_CLASSNAME+")").length,o==0&&!i.find(".ewGridUpperPanel, .ewGridLowerPanel")[0]&&i.hide(),i.find(".ewGridUpperPanel")[0]||i.css({"border-top-left-radius":0,"border-top-right-radius":0}),i.find(".ewGridLowerPanel")[0]||i.css({"border-bottom-left-radius":0,"border-bottom-right-radius":0}),i.data("isset",!0)}function ew_AddGridRow(e){var t=jQuery,n=t(e).closest("."+EW_GRID_CLASSNAME),r=n.find("table."+EW_TABLE_CLASSNAME),i=r.find("tr."+EW_ITEM_TEMPLATE_CLASSNAME);if(!e||!n[0]||!r[0]||!i[0])return;var s=t(r[0].rows).last();r.find("td."+EW_TABLE_LAST_ROW_CLASSNAME).removeClass(EW_TABLE_LAST_ROW_CLASSNAME);var o=i.clone(!0).removeClass(EW_ITEM_TEMPLATE_CLASSNAME),u=n.find("div.ewForm[id^=f][id$=grid]");u[0]||(u=n.find("form.ewForm[id^=f][id$=list]"));var a=u.is("div")?"_"+u.attr("id"):"",f=u.find("#key_count"+a),l=parseInt(f.val(),10)+1;o.attr({id:"r"+l+o.attr("id").substring(2),"data-rowindex":l});var c=i.find("script:contains('$rowindex$')");o.children("td").each(function(){this.innerHTML=this.innerHTML.replace(/\$rowindex\$/g,l)}),o.find(".ewIcon").closest("a, button").tooltip("destroy").tooltip({container:"body",placement:"bottom",trigger:"hover"}),f.val(l).after(t("<input>").attr({type:"hidden",id:"k"+l+"_action"+a,name:"k"+l+"_action"+a,value:"insert"})),s.after(o);var h=u.data("form");h&&(h.CreateEditor(),h.InitUpload()),c.each(function(){ew_AddScript(this.text.replace(/\$rowindex\$/g,l))}),ew_SetupTable(-1,r[0],!0)}function ew_DeleteGridRow(e,t){var n=jQuery,r=n(e).tooltip("destroy"),i=r.closest("."+EW_GRID_CLASSNAME+", ."+EW_MULTI_COLUMN_GRID_CLASSNAME),s=r.closest("tr, div[data-rowindex]"),o=s.closest("."+EW_TABLE_CLASSNAME);if(!e||!i[0]||!s[0])return;var u=parseInt(s.data("rowindex"),10),a=i.find("div.ewForm[id^=f][id$=grid]");a[0]||(a=i.find("form.ewForm[id^=f][id$=list]"));var f=a.data("form");if(!a[0]||!f)return;var l=a.is("div")?"_"+a.attr("id"):"",c="#key_count"+l,h=a.find(c),p=function(){s.remove(),i.is("."+EW_GRID_CLASSNAME)&&ew_SetupTable(-1,o[0],!0);if(u>0){var e=a.find("#k"+u+"_action"+l);e[0]?e.val(e.val()=="insert"?"insertdelete":"delete"):a.find(c).after(n("<input>").attr({type:"hidden",id:"k"+u+"_action"+l,name:"k"+u+"_action"+l,value:"delete"}))}};return n.isFunction(f.EmptyRow)&&f.EmptyRow(t)?p():ew_Prompt(ewLanguage.Phrase("DeleteConfirmMsg"),function(e){e&&p()}),!1}function ew_HtmlEncode(e){var t=String(e);return t=t.replace(/&/g,"&amp"),t=t.replace(/\"/g,"&quot;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t}function ew_ClearForm(e){var t=jQuery;t(e).find("[id^=x_],[id^=y_],[id^=n_]").each(function(){if(this.type=="checkbox"||this.type=="radio")this.checked=!1;else if(this.type=="select-one")this.selectedIndex=0;else if(this.type=="select-multiple")t(this).find("option").prop("selected",!1);else if(this.type=="text"||this.type=="textarea"||this.type=="hidden"&&ew_IsAutoSuggest(this))this.value="",this.type=="hidden"&&(ew_GetAutoSuggest(this).input.value="")})}function ew_MultiPage(e){var t=jQuery,n=this;this.$Form=null,this.FormID=e,this.PageIndex=1,this.MaxPageIndex=0,this.MinPageIndex=0,this.PageIndexes=[],this.$Pages=null,this.isTab=!1,this.isCollapse=!1,this.LastPageSubmit=!1,this.HideDisabledButton=!1,this.HideInactivePages=!1,this.LockTabs=!1,this.HideTabs=!1,this.ShowPagerTop=!1,this.ShowPagerBottom=!1,this.PagerTemplate='<nav><ul class="pager"><li class="previous ewPrev"><a href="#"><span class="icon-prev"></span> {Prev}</a></li><li class="next ewNext"><a href="#">{Next} <span class="icon-next"></span></a></li></ul></nav>';var r=function(e){e.preventDefault()},i=["LastPageSubmit","HideDisabledButton","HideInactivePages","LockTabs","HideTabs","ShowPagerTop"
,"ShowPagerBottom","PagerTemplate"];this.Set=function(){if(arguments.length==1&&t.isObject(arguments[0])){var e=arguments[0];for(var n in e)ew_InArray(n,i)>-1&&(this[n]=e[n])}},this.Init=function(){var e=this.PagerTemplate.replace(/\{prev\}/i,ewLanguage.Phrase("Prev")).replace(/\{next\}/i,ewLanguage.Phrase("Next"));this.isTab?(this.ShowPagerTop&&this.$Pages.closest(".tabbable").before(e),this.ShowPagerBottom&&this.$Pages.closest(".tabbable").after(e),this.$Form.find(".ewPrev").click(function(e){return n.$Pages.off("show.bs.tab",r).parent(".active").prevAll(":not(.ewHidden):not(.ewDisabled)").first().find("[data-toggle=tab]").click(),!1}),this.$Form.find(".ewNext").click(function(e){return n.$Pages.off("show.bs.tab",r).parent(".active").nextAll(":not(.ewHidden):not(.ewDisabled)").first().find("[data-toggle=tab]").click(),!1}),this.HideTabs&&this.$Form.find(".ewMultiPage > .tabbable > .nav-tabs").hide()):this.isCollapse&&(this.ShowPagerTop&&$collapses.closest(".panel-group").before(e),this.ShowPagerBottom&&$collapses.closest(".panel-group").after(e),this.$Form.find(".ewPrev").click(function(e){return n.$Pages.closest(".panel-heading").next("in").parent().prevAll(":not(.ewHidden)").first().find("[data-toggle=collapse]").click(),!1}),this.$Form.find(".ewNext").click(function(e){return n.$Pages.closest(".panel-heading").next("in").parent().nextAll(":not(.ewHidden)").first().find("[data-toggle=collapse]").click(),!1})),this.PageShow()},this.PageShow=function(){this.isTab?(this.LockTabs&&this.$Pages.on("show.bs.tab",r),this.$Pages.parent("li").each(function(){var e=t(this);n.HideInactivePages&&e.toggleClass("hidden",!e.hasClass("active")),n.LockTabs&&e.toggleClass("disabled",!e.hasClass("active"))})):this.isCollapse&&this.$Pages.closest(".panel").each(function(){var e=t(this);n.HideInactivePages&&e.toggleClass("hidden",!e.find(".in")[0])});var e=this.LastPageSubmit&&this.PageIndex!=this.MaxPageIndex;this.$Form.find("#btnAction").prop("disabled",e).toggle(!this.HideDisabledButton||!e),e=this.PageIndex<=this.MinPageIndex,this.$Form.find(".ewPrev").toggleClass("disabled",e).toggle(!this.HideDisabledButton||!e),e=this.PageIndex>=this.MaxPageIndex,this.$Form.find(".ewNext").toggleClass("disabled",e).toggle(!this.HideDisabledButton||!e)},this.GotoPage=this.GotoPageByIndex=function(e){if(e<=0||e<this.MinPageIndex||e>this.MaxPageIndex)return;if(this.PageIndex!=e){var t=this.$Pages.eq(e-1);if(this.isTab){var n=t.parent();n.is(":not(.ewHidden):not(.ewDisabled)")?t.click():n.nextAll(":not(.ewHidden):not(.ewDisabled)").first().find("[data-toggle=tab]").click()}else if(this.isCollapse){var n=t.closest(".panel");n.is(":not(.ewHidden)")?t.click():n.nextAll(":not(.ewHidden)").first().find("[data-toggle=collapse]").click()}}},this.GotoPageByElement=function(e){this.GotoPage(parseInt(t(e).data("page"),10)||-1)},this.GotoPageByElementId=function(e){var t=this.$Form.find("[data-page]").filter("[id='"+e+"'],[name='"+e+"'],[data-field='"+e+"']");this.GotoPageByElement(t)},this.TogglePage=function(e,t){this.isTab?this.$Pages.eq(e-1).parent().toggleClass("hidden ewHidden",!t):this.isCollapse&&this.$Pages.eq(e-1).closest(".panel").toggle("hidden ewHidden",!t)},this.Render=function(){this.$Form=t("#"+e),this.PageIndexes=this.$Form.find("[data-page]").map(function(){return parseInt(t(this).data("page"),10)}).get(),this.PageIndexes.sort(),this.MinPageIndex=this.PageIndexes[0],this.MaxPageIndex=this.PageIndexes[this.PageIndexes.length-1];var r=this.$Form.find("[data-toggle=tab]");if(r[0])this.$Pages=r,this.isTab=!0,r.on("shown.bs.tab",function(e){n.PageIndex=r.index(e.target)+1,n.PageShow(),t(t(this).attr("href")).find(".ewGoogleMap").each(function(){var e=ewGoogleMaps[this.id];e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))})}),this.PageIndex=r.index(r.parent(".active"))+1;else{var i=this.$Form.find("[data-toggle=collapse]");if(i[0]){this.$Pages=i,this.isCollapse=!0;var s=i.closest(".panel-heading").next();s.on("shown.bs.collapse",function(e){n.PageIndex=s.index(e.target)+1,n.PageShow(),t(this).find(".ewGoogleMap").each(function(){var e=ewGoogleMaps[this.id];e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))})}),this.PageIndex=s.index(s.hasClass("in"))+1}}t(function(){n.Init()})}}function ew_GetElements(e,t){var n=jQuery,r="[name='"+e+"']",i=e.split(" ");i.length==2&&(r="[data-table='"+i[0]+"'][data-field='"+ew_GetId(i[1])+"']:not([name^=o]):not([name^='x$'])");var t=n.isString(t)?/^#/.test(t)?t:"#"+t:t;r="input"+r+",select"+r+",textarea"+r+",button"+r;var s=t?n(t).find(r):n(r);return s.length==1&&s.is(":not(:checkbox):not(:radio)")?s[0]:s.get()}function ew_GetElement(e,t){var n=jQuery,t=n.isString(t)?"#"+t:t,r="#"+e.replace(/([\$\[\]])/g,"\\$1")+",[name='"+e+"']";return t?n(t).find(r)[0]:n(r).first()[0]}function ew_GetAncestorBy(e,t){while(e=e.parentNode)if(e&&e.nodeType==1&&(!t||t(e)))return e;return null}function ew_IsHidden(e){var t=jQuery;return t(e).css("display")=="none"&&!t(e).closest(".dropdown-menu")[0]&&!ew_IsHiddenTextArea(e)||ew_GetAncestorBy(e,function(e){var n=t(e);return n.css("display")=="none"&&!n.hasClass("tab-pane")&&!n.hasClass("collapse")})!=null}function ew_SameText(e,t){return String(e).toLowerCase()==String(t).toLowerCase()}function ew_SameStr(e,t){return String(e)==String(t)}function ew_InArray(e,t){if(!t)return-1;for(var n=0,r=t.length;n<r;n++)if(ew_SameStr(t[n],e))return n;return-1}function ew_GetOptValues(e,t){var n=jQuery,r=n.isString(e)?ew_GetElements(e,t):e;return r.options?n(r).find("option:selected[value!='']").map(function(){return this.value}).get():n.isNumber(r.length)?n(r).filter(":checked[value!='{value}']").map(function(){return this.value}).get():[r.value]}function ew_ClearOpt(e){var t=jQuery;if(e.options){var n=e.type=="select-multiple"||t(e).data("pleaseselect")===!1?0:1;for(var r=e.length-1;r>=n;r--)e.options[r]=null}else if(e.length){var i=ew_GetId(e),s=t(e).parent().parent().find("#dsl_"+i);s.data("options",[]).find("div").first().empty()}else if(ew_IsAutoSuggest(e)){var o=ew_GetAutoSuggest(e);o._options=[],o.input.value="",e.value=""}}function ew_GetId(e,t){var n=jQuery,r=n.isString(e)?e:n(e).attr("name")||n(e).attr("id");return t!==!1?r.replace(/\[\]$/,""):r}function ew_ValueSeparator(e,t){var n=jQuery,r=n(t).data("value-separator");return n.isArray(r)?r[e-1]:r||", "}function ew_DisplayValue(e,t){var n=jQuery,r=e[1];for(var i=2;i<=4;i++)if(e[i]&&e[i]!=""){var s=ew_ValueSeparator(i-1,t);if(n.isUndefined(s))break;r!=""&&(r+=s),r+=e[i]}return r}function ew_NewOpt(e,t,n){var r=jQuery,i=ewForms[n.id],s=ew_GetId(e),o=ew_GetId(e,!1),u,a=t[0],f={lf:t[0],df1:t[1],df2:t[2],df3:t[3],df4:t[4]};i.Lists(o).Template&&!ew_IsAutoSuggest(e)?u=i.Lists(o).Template.render(f):u=ew_DisplayValue(t,e)||a;var l={data:f,name:s,form:n.$Element,value:a,text:u};if(e.options)r.extend(l,{option:r("<option/>").val(l.value).html(l.text)}),r(document).trigger("newoption",[l]),r(e).append(l.option);else if(e.length){var c=r(ew_GetElement("dsl_"+s,n)),h=c.data("options");c[0]&&h&&(h[h.length]={val:l.value,lbl:l.text})}else if(ew_IsAutoSuggest(e)){var p=ew_GetAutoSuggest(e);p._options[p._options.length]={val:l.value,lbl:l.text}}return l.text}function ew_RenderOpt(e){var t=jQuery,n=ew_GetId(e),r=ew_GetForm(e),i=t(e).parent().parent().find("#dsl_"+n);if(!i[0]||!i.data("options"))return;var s=i.parent().find("#tp_"+n);if(!s[0])return;var o=EW_IS_MOBILE?1:parseInt(i.data("repeatcolumn"),10)||5,u=s.contents(),a=i.data("options"),f=u.attr("type"),l=i.prevAll(".dropdown-toggle"),c=i.prevAll(".ewDropdownListClear");if(a&&a.length){if(o>1||f=="checkbox"||!l[0]){var h=t('<table class="ewItemTable"></table>');f=="checkbox"&&h.click(function(e){e.stopPropagation()});for(var p=0,d=a.length;p<d;p++){p%o==0&&($tr=t("<tr></tr>"));var v=u.clone(!0).val(a[p].val).click(function(e){if(l[0]){var n=h.find("input[name='"+this.name+"']:checked"),r=n.map(function(){return t(this).parent().text()}).get(),i=r.length>(t(this).data("maxcount")||3)?ewLanguage.Phrase("CountSelected").replace("%s",r.length):r.join(", ");l.html(r.length?i:ewLanguage.Phrase("PleaseSelect")),c.toggle(r.length>0)}}),m=t('<label class="'+f+'-inline"></label>').append(v.attr("id",v.attr("id")+"_"+p),a[p].lbl),g={name:n,form:r,value:a[p].val,text:a[p].lbl,option:m};t(document).trigger("newoption",[g]),t("<td></td>").append(g.option).appendTo($tr);if(p%o==o-1)h.append($tr);else if(p==d-1){for(var y=p%o+1;y<o;y++)$tr.append("<td></td>");h.append($tr)}}i.find("div").first().append(h)}else{var b=t('<div class="list-group"></div>');for(var p=0,d=a.length;p<d;p++){var v=u.clone(!0).val(a[p].val).click(function(e){var n=t(this).closest(".list-group-item");n.hasClass("active")&&(this.checked=!1),n.siblings(".list-group-item").removeClass("active"),n.toggleClass("active",this.checked),l.html(this.checked?n.text():ewLanguage.Phrase("PleaseSelect")),c.toggle(this.checked)}),m=t('<label class="'+f+'-inline"></label>').append(v.attr("id",v.attr("id")+"_"+p),a[p].lbl),w=t('<a class="list-group-item" href="#"></a>').append(m),g={name:n,form:r,value:a[p].val,text:a[p].lbl,option:w};t(document).trigger("newoption",[g]),b.append(g.option)}i.find("div").first().append(b)}var E=t.trim(l.html());c.toggle(!!E&&E!=ewLanguage.Phrase("PleaseSelect")).off().click(function(e){i.find("[data-field]:radio,[data-field]:checkbox").prop("checked",!1),i.find(".list-group-item.active").removeClass("active"),l.html(ewLanguage.Phrase("PleaseSelect")),c.hide()})}i.hasClass("dropdown-menu")||i.show(),i.data("options",[])}function ew_SelectOpt(e,t){function u(e){if(!n(e).data("autoselect"))return!1;var t=ew_GetForm(e);if(t){if(/s(ea)?rch$/.test(t.id))return!1;var r=ewForms[t.id].Lists(e.id);return r&&r.ParentFields.length==0?!1:!0}return!1}if(!e||!t)return;var n=jQuery,r=n(e);if(t[0])if(e.options)n(e).val(t),e.type=="select-one"&&e.selectedIndex==-1&&(e.selectedIndex=0);else if(e.length)e.length==1&&e[0].type=="checkbox"&&e[0].value!="{value}"?e[0].checked=ew_ConvertToBool(e[0].value)===ew_ConvertToBool(t[0]):r.val(t).closest(".ewDropdownList").find(".ewDropdownListClear").show();else if(ew_IsAutoSuggest(e)&&t.length==1){var i=ew_GetAutoSuggest(e);for(var s=0,o=i._options.length;s<o;s++)if(i._options[s].val==t[0]){e.value=i._options[s].val,i.input.value=i._options[s].lbl;break}}else e.type&&(e.value=t.join(","));if(e.options)e.type=="select-one"&&e.options.length==2&&!e.options[1].selected&&u(e)?e.options[1].selected=!0:e.type=="select-multiple"&&e.options.length==1&&!e.options[0].selected&&u(e)&&(e.options[0].selected=!0);else if(e.length){e.length==2&&u(e[1])&&(e[1].checked=!0),e[0].type=="radio"&&r.filter(":checked").closest(".list-group-item").addClass("active");var a=r.closest(".dropdown-menu"),f=a.prevAll(".dropdown-toggle");if(f[0]){var l=a.find("input[name='"+e[0].name+"']:checked"),c=l.map(function(){return n(this).parent().text()}).get(),h=c.length>(r.data("maxcount")||3)?ewLanguage.Phrase("CountSelected").replace("%s",c.length):c.join(", ");f.html(c.length?h:ewLanguage.Phrase("PleaseSelect"))}}else if(ew_IsAutoSuggest(e)){var i=ew_GetAutoSuggest(e);i._options.length==1&&u(e)&&(e.value=i._options[0].val,i.input.value=i._options[0].lbl)}}function ew_AutoSuggest(e){var t=this,n=jQuery,r=e.id,i=e.form,s=e.forceSelect,o=r.replace(/^[xy](\d*|\$rowindex\$)_/,"x_"),u=RegExp.$1,a={typeahead:{}};if(u=="$rowindex$")return a;var f=i.GetElement(),l=i.GetElement("sv_"+r);if(!l)return a;var c=i.GetElement("sc_"+r),h=i.GetElement("q_"+r),p=i.Lists[o].ParentFields.slice();for(var d=0,v=p.length;d<v;d++)p[d]=p[d].replace(/^x_/,"x"+u+"_");this.input=l,this.element=i.GetElement(r),this.highlight=!0,this.hint=!0,this.minLength=1,this.limit=EW_AUTO_SUGGEST_MAX_ENTRIES,this.templates={},this._options=[];var m=n(this.input),g=n(this.element);this.$input=m,this.$element=g,m.val()&&g.val()&&this._options.push({val:g.val(),lbl:m.val()}),this.formatResult=function(e){return ew_DisplayValue(e,this.element)||e[0]},this.setValue=function(e){e=e||m.val();var t=m.data("results")?n.map(m.data("results"),function(t,n){if(t["value"]==e)return n}):[];if(t.length==0){if(this._options&&this._options.length&&this._options[this._options.length-1].lbl==e)return;if(s&&e){m.typeahead("val","").attr("placeholder",ewLanguage.Phrase("ValueNotExist")).parent().append('<span class="glyphicon glyphicon-warning-sign form-control-feedback"></span>').addClass("has-error has-feedback"),g.val("").change();return}}else if(!/s(ea)?rch$/.test(f.id)||s){var r=t[0];r>-1&&(e=m.data("results")[r][0])}e!==g.val()&&g.val(e).change()},this.generateRequest=function(){var e=h.value;if(p.length>0)for(var t=0,n=p.length;t<n;t++){var r=ew_GetOptValues(p[t],f);e+="&v"+(t+1)+"="+encodeURIComponent(r.join(","))}return"ajax=autosuggest&name="+this.element.name+"&"+e},m.on("typeahead:selected",function(e,n){t.setValue(n.value)}).blur(function(e){var n=m.data("ttTypeahead");if(n&&n.dropdown.isOpen&&!n.dropdown.isEmpty){var r=m.data("ttTypeahead").dropdown._getCursor().index();if(r>-1){var i=m.data("results")[r][1];m.typeahead("val",i)}}t.setValue()}).focus(function(e){m.attr("placeholder",m.data("placeholder")).closest(".has-error.has-feedback").removeClass("has-error has-feedback").find(".form-control-feedback").remove()}),g.data("autosuggest",this),n(function(){var s={datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.value)},queryTokenizer:Bloodhound.tokenizers.whitespace,limit:t.limit,remote:{url:EW_LOOKUP_FILE_NAME,replace:function(e,n){return this.ajax.data=t.generateRequest(),e+"?q="+encodeURIComponent(n)+"&rnd="+ew_Random()},ajax:{type:"POST",data:t.generateRequest()},filter:function(e){m.data("results",e||[]);var r=n.map(m.data("results"),function(e){var n=e.value=t.formatResult(e);return{lf:e[0],df1:e[1],df2:e[2],df3:e[3],df4:e[4],value:n}});return r}}};g.trigger("bloodhound",[s]),t.engine=new Bloodhound(s),t.engine.initialize();if(i.Lists[o].Template){var u=i.Lists[o].Template;t.templates.suggestion=n.proxy(u.render,u)}var a=[{highlight:t.highlight,minLength:t.minLength,hint:t.hint},{name:i.ID+"-"+r,source:t.engine.ttAdapter(),templates:t.templates}];g.trigger("typeahead",[a]),m.typeahead.apply(m,a),m.off("blur.tt"),t.typeahead=m.data("ttTypeahead"),t.typeahead.$node.css("display","").addClass("ewAutoSuggest");var f=t.typeahead.dropdown.$menu.css("z-index",9001);e.minWidth&&f.css("min-width",e.minWidth),e.maxHeight&&f.find("div:first").css({"max-height":e.maxHeight,"overflow-y":"auto"})})}function ew_ExecScript(e,t){var n,r=0,i=/<script([^>]*)>([\s\S]*?)<\/script\s*>/ig;while((n=i.exec(e))!=null){var s=RegExp.$2;/(\s+type\s*=\s*['"]*(text|application)\/(java|ecma)script['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1)&&ew_AddScript(s,"scr_"+t+"_"+r++)}}function ew_StripScript(e){var t,n=/<script([^>]*)>([\s\S]*?)<\/script\s*>/ig,r=e;while((t=n.exec(e))!=null){var i=RegExp.lastMatch;/(\s+type\s*=\s*['"]*(text|application)\/(java|ecma)script['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1)&&(r=r.replace(i,""))}return r}function ew_AddScript(e,t){var n=document.createElement("SCRIPT");return t&&(n.id=t),n.type="text/javascript",n.text=e,document.body.appendChild(n)}function ew_RemoveScript(e){e&&jQuery("script[id^='scr_"+e+"_']").remove()}function ew_SaveOpt(e){var t=jQuery,n=t(e),r=n.closest("[id^=el]").find("#dsl_"+ew_GetId(e));if(!r[0])return[];var i=n.filter(":checked").map(function(){return this.value}).get();return ew_ClearOpt(e),r.data("options",n.filter("[value!='{value}']").map(function(){var e=t(this).parent().contents().not(this);return{val:this.value,lbl:e}}).get()),i}function ew_GetOptArray(e){var t=jQuery;return e.options?t(e.options).map(function(){return{value:this.value,name:this.text}}).get():e.length?t(e).filter("[value!='{value}']").map(function(){var e=t(this).parent().contents().not(this);return{value:this.value,name:e.text()}}).get():[]}function ew_AddOptSuccess(e){var t=jQuery,n=ewAddOptDialog,r;if(!n)return;if(e)try{r=t.parseJSON(e)}catch(i){}if(r&&r.length>0){var s=r[0],o=n.data("args").el,u="x_",a=-1;o.match(/^(x(\d+)_)/)&&(u=RegExp.$1,a=parseInt(RegExp.$2,10));var f=function(e){return e.replace(/^x_/,u)},l=ewForms(n.data("args").lnk);n.modal("hide");var c=l.$Element[0],h=ew_GetElements(o,c);if(h){var p=o.replace(new RegExp("^"+u),"x_"),d=l.Lists[p].LinkField,v=l.Lists[p].DisplayFields,m=l.Lists[p].FilterFields,g=l.Lists[p].ParentFields,y=d!=""?s[d]:"",b=[y];for(var w=0,E=v.length;w<E;w++)b[b.length]=v[w]in s?s[v[w]]:"";for(var w=0,E=m.length;w<E;w++)b[b.length]=m[w]in s?s[m[w]]:"";if(y&&v.length>0&&b[1]){var S=ew_GetId(o,!1),x=S.replace(new RegExp("^"+u),"x_");if(l.Lists[x].Ajax===null){var T=l.Lists[x].Options;T[T.length]=b}var N=[];for(var w=0,E=g.length;w<E;w++)N[N.length]=ew_GetOptValues(f(g[w]),c);var C={data:b,parents:N,valid:!0,name:ew_GetId(h),form:c};t(document).trigger("addoption",[C]);if(C.valid){var T=ew_GetOptArray(h),k=[];!h.options&&h.length&&(k=ew_SaveOpt(h));var L=ew_NewOpt(h,b,c);if(h.options)h.options[h.options.length-1].selected=!0,t(h).change().focus();else if(h.length){ew_RenderOpt(h),h=ew_GetElements(S,c),k.length>0&&ew_SelectOpt(h,k);if(h.length>0){var o=t(h).filter("[value!='{value}']").last()[0];(o.type=="checkbox"||o.type=="radio")&&o.click(),o.focus()}}else if(ew_IsAutoSuggest(h)){var A=ew_GetAutoSuggest(h);t(h).val(y).change(),t(A.input).val(L).focus()}var O=t(c),M=O.is("div")?"_"+O.attr("id"):"",_=O.find("#key_count"+M).val();if(_>0)for(var w=1;w<=_;w++){if(w==a)continue;var D=ew_GetElements(p.replace(/^x/,"x"+w),c),P=ew_GetOptArray(D),k=[];if(t.param(T)!=t.param(P))continue;!D.options&&D.length&&(k=ew_SaveOpt(D)),ew_NewOpt(D,b,c),!D.options&&D.length&&(ew_RenderOpt(D),k.length>0&&ew_SelectOpt(D,k))}}}}}else{var H,B=n.find("div.ewMessageDialog").html(""),j=t("<div></div>").html(e).find("div.ewMessageDialog");if(j[0])H=j.html();else{H=e;if(!H||t.trim(H)=="")H=ewLanguage.Phrase("InsertFailed");H='<p class="text-danger">'+H+"</p>"}B.html(H).show()}}function ew_AddOptDialogHide(){if($dlg=ewAddOptDialog)ew_RemoveScript($dlg.data("args").el),$dlg.removeData("args").find(".modal-body form").data("form").DestroyEditor(),$dlg.find(".modal-body").html(""),$dlg.find(".modal-footer .btn-primary").unbind()}function ew_ModalDragStart(e,t){var n=jQuery,r=n(this),i=n("body");t.limit=i.offset(),t.limit.bottom=t.limit.top+i.outerHeight()-r.outerHeight(),t.limit.right=t.limit.left+i.outerWidth()-r.outerWidth()}function ew_ModalDrag(e,t){var n=jQuery,r=n(this),i=parseInt(r.css("margin-left"),10);r.css({top:Math.min(t.limit.bottom,Math.max(t.limit.top,t.offsetY)),left:Math.min(t.limit.right-i,Math.max(t.limit.left-i,t.offsetX-i))})}function ew_AddOptDialogShow(e){var t=jQuery,n=ewAddOptDialog||t("#ewAddOptDialog").on("hidden.bs.modal",ew_AddOptDialogHide),r=function(e){n.modal("hide"),ew_Alert("Server Error "+e.status+": "+e.statusText)},i=function(){var e=ewAddOptDialog,n=e.find(".modal-body form")[0],i=ewForms[n.id];return i.UpdateTextArea(),i.Validate()&&(i.DestroyEditor(),t.post(n.action,t(n).serialize(),ew_AddOptSuccess).fail(r)),!1};n.modal("hide"),n.data("args",e);var s=function(r){var s=ewForms(e.lnk),o="x_";e.el.match(/^(x\d+_)/)&&(o=RegExp.$1);var u=e.el.replace(o,"x_"),a=s.Lists[u].ParentFields,f=s.Lists[u].FilterFields,l=s.Form,c=[];for(var h=0,p=a.length;h<p;h++){var d=ew_GetElements(a[h].replace(/^x_/,o),l);c[c.length]=ew_GetOptValues(d)}n.find(".modal-title").html(t(e.lnk).text()),n.find(".modal-body").html(ew_StripScript(r));var l=n.find(".modal-body form")[0];if(l){t(l).keypress(function(e){if(e.which==13)return i()});for(var h=0,p=c.length;h<p;h++){var v=l.elements[f[h]];v&&ew_SelectOpt(v,c[h])}}ewAddOptDialog=n.modal("show"),n.find(".modal-footer .btn-primary").click(i).focus(),ew_ExecScript(r,e.el)};t.get(e.url,s).fail(r)}function ew_SearchSuccess(e){var t=jQuery,n=ewSearchDialog,r;if(!n)return;if(e)try{r=t.parseJSON(e)}catch(i){}if(r&&r.length>0){n.modal("hide");var s=r[0],o=s.url;window.location=o}else n.find(".modal-body").html(ew_StripScript(e))}function ew_SearchDialogHide(){if($dlg=ewSearchDialog){ew_RemoveScript("SearchDialog");var e=$dlg.removeData("args").find(".modal-body form").data("form");e&&e.DestroyEditor(),$dlg.find(".modal-body").html(""),$dlg.find(".modal-footer .btn-primary").unbind()}}function ew_SearchDialogShow(e){var t=jQuery,n=ewSearchDialog||t("#ewSearchDialog").on("hidden.bs.modal",ew_SearchDialogHide),r=function(e){n.modal("hide"),e.status&&ew_Alert("Server Error "+e.status+": "+e.statusText)},i=function(){var e=ewSearchDialog,n=e.find(".modal-body form")[0],i=ewForms[n.id];return i.UpdateTextArea(),i.Validate()&&(i.DestroyEditor(),t.post(n.action,t(n).serialize(),ew_SearchSuccess).fail(r)),!1};ew_SearchDialogHide(),n.data("args",e);var s=function(r){var s=t(r);n.find(".modal-title").html(t(e.lnk).data("caption")||t(e.lnk).data("original-title"));var o=ew_StripScript(r).match(/<body>[\s\S]*<\/body>/i);n.find(".modal-body").append(t(o[0]).not("div[id^=ew].modal, #ewTooltip")),n.find(".modal-body form").keypress(function(e){if(e.which==13)return i()}),ewSearchDialog=n.modal("show"),n.find(".modal-footer .btn-primary").click(i).focus(),ew_ExecScript(r,"SearchDialog")},o=e.url+"?modal=1&rnd="+ew_Random();t.get(o,s).fail(r)}function ew_AutoFill(e){var t=jQuery,n=ewForms(e).$Element[0];if(!n)return;var r=ew_GetOptValues(e),i=ew_GetId(e),s=ew_GetElement("ln_"+i,n);if(!s||s.value=="")return;var o=s.value.split(","),u=function(r){var s=r||"",u=s?s[0]:[];for(var a=0;a<o.length;a++){var l=ew_GetElements(o[a],n);if(l){var c=t.isValue(u[a])?u[a]:"",h={result:u,data:c,form:n,name:i,target:o[a],cancel:!1,trigger:!0};t(e).trigger("autofill",[h]);if(h.cancel)continue;c=h.data,l.options||l.length&&l[0].type=="radio"?ew_SelectOpt(l,c.split(",")):l.length&&l[0].type=="checkbox"?ew_SelectOpt(l,c.split(",")):ew_IsAutoSuggest(l)?(l.value=c,ew_GetAutoSuggest(l).input.value=c,ew_UpdateOpt.call(ewForms[n.id],l)):ew_IsHiddenTextArea(l)?(l.value=c,t(l).data("editor").set()):l.value=c,h.trigger&&t(l).change()}}};if(r.length>0&&r[0]!=""){var a={ajax:"autofill",form:n.id,name:i,target:s.value,q:r[0],token:EW_TOKEN};t(n).is("div.ewForm[id^=f][id$=grid]")&&(a.grid=n.id),t.post(ew_CurrentPage(),a,u,"json")}else u()}function ew_Tooltip(e,t){var n=jQuery,r=n(t),i=n("#"+r.data("tooltip-id")),s=r.data("trigger")||"hover",o=r.data("placement")||(EW_CSS_FLIP?"left":"right");if(!i[0]||n.trim(i.text())==""&&!i.find("img[src!='']")[0])return;r.data("bs.popover")||r.popover({html:!0,placement:o,trigger:s,delay:100,container:n("#ewTooltip")[0],content:i.html()}).on("show.bs.popover",function(e){var t=r.data("bs.popover").tip();(wd=r.data("tooltip-width"))&&t.css("max-width",parseInt(wd,10)+"px")}).on("shown.bs.popover",function(e){if(o!="left"&&o!="right")return;var t=n(e.target),i=t.width(),s=t.height(),u=n(document),a=n(document.body),f=r.data("bs.popover").tip(),l=f.width(),c=f.position(),h=u.scrollTop()+a.outerHeight()-f.outerHeight();c.top=Math.max(u.scrollTop(),Math.min(h,c.top)),f.css("top",c.top+"px");var p=f.find(".arrow"),d=t.position().top-c.top+s/2-p.height(),v=(parseInt(f.css("border-top-left-radius"),10)||6)-parseInt(p.css("margin-top"),10),m=f.height()-v-p.height();p.css("top",Math.max(v,Math.min(d,m))+"px")})}function ew_EmailDialogShow(e){var t=jQuery,n=ewEmailDialog||t("#ewEmailDialog");if(!n)return;if(e.sel&&!ew_KeySelected(e.f)){ew_Alert(ewLanguage.Phrase("NoRecordSelected"));return}var r=n.find(".modal-body form"),i=r.data("form");i||(i=new ew_Form(r.attr("id")),i.Validate=function(){var e,t=this.GetForm();return e=t.elements.sender,e&&!ew_HasValue(e)?this.OnError(e,ewLanguage.Phrase("EnterSenderEmail")):e&&!ew_CheckEmailList(e.value,1)?this.OnError(e,ewLanguage.Phrase("EnterProperSenderEmail")):(e=t.elements.recipient,e&&!ew_HasValue(e)?this.OnError(e,ewLanguage.Phrase("EnterRecipientEmail")):e&&!ew_CheckEmailList(e.value,EW_MAX_EMAIL_RECIPIENT)?this.OnError(e,ewLanguage.Phrase("EnterProperRecipientEmail")):(e=t.elements.cc,e&&!ew_CheckEmailList(e.value,EW_MAX_EMAIL_RECIPIENT)?this.OnError(e,ewLanguage.Phrase("EnterProperCcEmail")):(e=t.elements.bcc,e&&!ew_CheckEmailList(e.value,EW_MAX_EMAIL_RECIPIENT)?this.OnError(e,ewLanguage.Phrase("EnterProperBccEmail")):(e=t.elements.subject,e&&!ew_HasValue(e)?this.OnError(e,ewLanguage.Phrase("EnterSubject")):!0))))},i.Submit=function(){if(!this.Validate())return!1;var i=r.serialize(),s="";e.f&&e.sel&&(s=t(e.f).find("input:checkbox[name='key_m[]']:checked").serialize()),e.key&&(i+="&"+t.param(e.key));var o=this.GetForm(),u=ew_GetOptValues("contenttype",o);return e.url&&u=="html"?(n.modal("hide"),ew_Export(e.f,e.url,"email",!0,e.sel,o)):t.post(e.f.action,i+"&"+s,function(e){ew_ShowMessage(e)}),!0},r.data("form",i)),n.modal("hide").find(".modal-title").html(e.hdr),n.find(".modal-footer .btn-primary").unbind().click(function(e){e.preventDefault(),i.Submit()&&n.modal("hide")}),ewEmailDialog=n.modal("show")}function ew_Ajax(e,t,n){if(!e)return undefined;var r=jQuery,i=r.extend({s:e},r.isObject(t)?t:{q:t});if(!r.isFunction(n)){var s=r.ajax({url:EW_LOOKUP_FILE_NAME,async:!1,type:"POST",data:i}).responseText,o=r.parseJSON(s);return o.length==1?(o=o[0],r.isArray(o)&&o.length==1?o[0]:o):o}r.post(EW_LOOKUP_FILE_NAME,i,n,"json")}function ew_CurrentPage(){return location.href.split("?")[0]}function ew_ToggleSrchOpr(e,t){var n=this.form.elements[e];if(!n)return;n.value=n.value!=t?t:"="}function ew_CheckUSDate(e){return ew_CheckDateEx(e,"us",EW_DATE_SEPARATOR)}function ew_CheckShortUSDate(e){return ew_CheckDateEx(e,"usshort",EW_DATE_SEPARATOR)}function ew_CheckDate(e){return ew_CheckDateEx(e,"std",EW_DATE_SEPARATOR)}function ew_CheckShortDate(e){return ew_CheckDateEx(e,"stdshort",EW_DATE_SEPARATOR)}function ew_CheckEuroDate(e){return ew_CheckDateEx(e,"euro",EW_DATE_SEPARATOR)}function ew_CheckShortEuroDate(e){return ew_CheckDateEx(e,"euroshort",EW_DATE_SEPARATOR)}function ew_CheckDateEx(e,t,n){if(!e||e.length=="")return!0;while(e.indexOf("  ")>-1)e=e.replace(/  /g," ");e=e.replace(/^\s*|\s*$/g,"");var r=e.split(" ");if(r.length>0){var i,s,o,u;i=/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1])$/;if(ar=i.exec(r[0]))s=ar[1],o=ar[2],u=ar[3];else{var a="\\"+n;switch(t){case"std":i=new RegExp("^(\\d{4})"+a+"([0]?[1-9]|[1][0-2])"+a+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"stdshort":i=new RegExp("^(\\d{2})"+a+"([0]?[1-9]|[1][0-2])"+a+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"us":i=new RegExp("^([0]?[1-9]|[1][0-2])"+a+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+a+"(\\d{4})$");break;case"usshort":i=new RegExp("^([0]?[1-9]|[1][0-2])"+a+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+a+"(\\d{2})$");break;case"euro":i=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+a+"([0]?[1-9]|[1][0-2])"+a+"(\\d{4})$");break;case"euroshort":i=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+a+"([0]?[1-9]|[1][0-2])"+a+"(\\d{2})$")}if(!i.test(r[0]))return!1;var f=r[0].split(n);switch(t){case"std":case"stdshort":s=ew_UnformatYear(f[0]),o=f[1],u=f[2];break;case"us":case"usshort":s=ew_UnformatYear(f[2]),o=f[0],u=f[1];break;case"euro":case"euroshort":s=ew_UnformatYear(f[2]),o=f[1],u=f[0]}}if(!ew_CheckDay(s,o,u))return!1}return r.length>1&&!ew_CheckTime(r[1])?!1:!0}function ew_UnformatYear(e){return e.length==2?e>EW_UNFORMAT_YEAR?"19"+e:"20"+e:e}function ew_CheckDay(e,t,n){e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10);var r=ew_InArray(t,[4,6,9,11])>-1?30:31;return t==2&&(r=e%4>0||e%100==0&&e%400>0?28:29),ew_CheckRange(n,1,r)}function ew_CheckInteger(e){return!e||e.length==0?!0:e.indexOf(EW_DECIMAL_POINT)>-1?!1:ew_CheckNumber(e)}function ew_CheckNumber(e){e=String(e);if(!e||e.length==0)return!0;e=e.replace(/^\s*|\s*$/g,"");var t=new RegExp("^[+-]?(\\d{1,3}("+(EW_THOUSANDS_SEP?"\\"+EW_THOUSANDS_SEP+"?":"")+"\\d{3})*(\\"+EW_DECIMAL_POINT+"\\d+)?|\\"+EW_DECIMAL_POINT+"\\d+)$");return t.test(e)}function ew_StrToFloat(e){e=String(e);if(EW_THOUSANDS_SEP!=""){var t=new RegExp("\\"+EW_THOUSANDS_SEP,"g");e=e.replace(t,"")}return EW_DECIMAL_POINT!=""&&(e=e.replace(EW_DECIMAL_POINT,".")),parseFloat(e)}function ew_StrToDate(e){var t=/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1]) (?:(0\d|1\d|2[0-3]):([0-5]\d):([0-5]\d))?$/,n=e.replace(t,"$1 $2 $3 $4 $5 $6").split(" ");return new Date(n[0],n[1]-1,n[2],n[3],n[4],n[5])}function ew_CheckRange(e,t,n){if(!e||e.length==0)return!0;var r=jQuery;return(r.isNumber(t)||r.isNumber(n))&&ew_CheckNumber(e)&&(e=ew_StrToFloat(e)),!r.isNull(t)&&e<t?!1:!r.isNull(n)&&e>n?!1:!0}function ew_CheckTime(e){if(!e||e.length==0)return!0;e=e.replace(/^\s*|\s*$/g,"");var t=/^(0\d|1\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/;return t.test(e)}function ew_CheckPhone(e){if(!e||e.length==0)return!0;e=e.replace(/^\s*|\s*$/g,"");var t=/^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/;return t.test(e)}function ew_CheckZip(e){if(!e||e.length==0)return!0;e=e.replace(/^\s*|\s*$/g,"");var t=/^\d{5}$|^\d{5}-\d{4}$/;return t.test(e)}function ew_CheckCreditCard(e){if(!e||e.length==0)return!0;var t=e.replace(/\D/g,"");if(t.length==0)return!1;var n=t.length%2==1?!1:!0,r,i=0;for(var s=0,o=t.length;s<o;s++)r=parseInt(t.charAt(s),10),n?(r*=2,i+=r%10,r/10>=1&&i++,n=!1):(i+=r,n=!0);return i%10==0}function ew_CheckSSC(e){if(!e||e.length==0)return!0;e=e.replace(/^\s*|\s*$/g,"");var t=/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/;return t.test(e)}function ew_CheckEmailList(e,t){if(!e||e.length==0)return!0;var n=e.replace(/,/g,";").split(";");for(var r=0,i=n.length;r<i;r++){if(t>0&&i>t)return!1;if(!ew_CheckEmail(n[r]))return!1}return!0}function ew_CheckEmail(e){if(!e||e.length==0)return!0;e=e.replace(/^\s*|\s*$/g,"");var t=/^[\w.%+-]+@[\w.-]+\.[A-Z]{2,18}$/i;return t.test(e)}function ew_CheckGUID(e){if(!e||e.length==0)return!0;e=e.replace(/^\s*|\s*$/g,"");var t=/^\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}$/,n=/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/;return t.test(e)||n.test(e)}function ew_CheckByRegEx(e,t){return!e||e.length==0?!0:e.match(t)?!0:!1}function ew_ShowMessage(e){if(window.location!=window.parent.location&&parent.ew_ShowMessage)return parent.ew_ShowMessage(e);var t=jQuery,n=t("div.ewMessageDialog:hidden:first"),r=n.find(".alert").removeClass("alert");t.each(["success","info","warning","danger"],function(e,t){r.hasClass("alert-"+t)&&r.toggleClass("alert-"+t+" text-"+t)});var i=e||(n.length?EW_IS_MOBILE?n.text():n.html():"");if(t.trim(i)=="")return;if(EW_IS_MOBILE)alert(i);else{var s=t("#ewMsgBox");s.find(".modal-body").html(i),s.modal("show")}}function ew_Random(){return Math.floor(Math.random()*100001)+1e5}function ew_Upload(e,t){var n=jQuery,r=n(t);if(r.data("blueimpFileupload"))return;var i=r.attr("name"),s=i.replace(/\$/g,"\\$"),o=r.data("table"),u=r.is("[multiple]"),a=r.closest(".form-group,[id^='el_']"),f=a.find(".btn").css("display")=="none"||r.closest("form").find("#a_confirm").val()=="F",l=a.find("#ft_"+s),c=a.find("#fn_"+s),h=a.find("#fa_"+s),p=a.find("#fs_"+s),d=a.find("#fx_"+s),v=a.find("#fm_"+s),m=a.find("#fc_"+s),g=function(e,t){if(t.result.files[0].error)return;var n=t.result.files[0].name,r=u?c.val()?c.val().split(EW_MULTIPLE_UPLOAD_SEPARATOR):[]:[];r[r.length]=n,c.val(r.join(EW_MULTIPLE_UPLOAD_SEPARATOR)),h.val("0"),u||l.find("tr:not(:last)").remove()},y=function(e,t){var r={},i=n(e.originalEvent.target).data("url");i&&i.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g,function(e,t,n){t&&(r[t]=n)});var s=r.id;if(s&&r[s]){var o=r[s],u=c.val()?c.val().split(EW_MULTIPLE_UPLOAD_SEPARATOR):[];n.each(u,function(e,t){if(t==decodeURIComponent(o))return u.splice(e,1),!1}),c.val(u.join(EW_MULTIPLE_UPLOAD_SEPARATOR)),h.val("0")}},b=function(e,t){var r=c.val()?c.val().split(EW_MULTIPLE_UPLOAD_SEPARATOR):[];for(var i=0;i<t.files.length;i++)r[r.length]=t.files[i].name;var s=parseInt(m.val(),10);if(n.isNumber(s)&&s>0&&r.length>s)return ew_Alert(ewLanguage.Phrase("UploadErrMsgMaxNumberOfFiles")),!1;var o=parseInt(p.val(),10);if(n.isNumber(o)&&o>0&&r.join(EW_MULTIPLE_UPLOAD_SEPARATOR).length>o)return ew_Alert(ewLanguage.Phrase("UploadErrMsgMaxFileLength")),!1},w=function(e){!u&&c.val()&&(confirm(ewLanguage.Phrase("UploadOverwrite"))||(e.preventDefault(),e.stopPropagation()))},E=function(e){var t=n();return n.each(e.files,function(r,i){var s=n('<tr class="template-upload fade"><td class="preview"><span class="fade"></span></td><td class="name"></td><td class="size"></td>'+(i.error?'<td class="error text-danger" colspan="2"></td>':'<td><div class="progress"><div class="bar" style="width: 0%;"></div></div></td><td><button type="button" class="btn btn-default btn-sm start">'+ewLanguage.Phrase("UploadStart")+"</button></td>")+'<td><button type="button" class="btn btn-default btn-sm cancel">'+ewLanguage.Phrase("UploadCancel")+"</button></td></tr>");s.find(".name").text(i.name),s.find(".size").text(e.formatFileSize(i.size)),s.find(".start").click(w),s.find(".error").text(i.error),t=t.add(s)}),t},S=function(
e){var t=n();return n.each(e.files,function(r,i){var s=n('<tr class="template-download fade">'+(i.error?'<td></td><td class="name"></td><td class="size"></td><td class="error text-danger" colspan="2"></td>':'<td class="preview"></td><td class="name"><a></a></td><td class="size"></td><td colspan="2"></td>')+(f?"":'<td><button type="button" class="btn btn-default btn-sm delete">'+ewLanguage.Phrase("UploadDelete")+"</button></td>")+"</tr>");s.find(".size").text(e.formatFileSize(i.size));if(i.error)s.find(".name").text(i.name),s.find(".error").text(i.error),i.deleteUrl||s.find(".delete").click(function(){n(this).closest(".template-download").remove(),x()});else{var o=s.find(".name a").text(i.name);i.url&&o.attr("href",i.url).attr("target","_blank"),i.thumbnailUrl&&/\.(bmp|gif|jpe?g|png)$/i.test(i.name)&&(EW_USE_COLORBOX&&o.colorbox(ewLightboxSettings),s.find(".preview").append('<a><img style="width: '+EW_UPLOAD_THUMBNAIL_WIDTH+'px;"></a>').find("img").prop("src",i.thumbnailUrl)),s.find(".delete").attr("data-type",i.deleteType).attr("data-url",i.deleteUrl)}t=t.add(s)}),t},x=function(){l.css("margin-top",l.find("tr")[0]&&!f?"10px":"0")},T=function(){r.closest("span.fileinput-button").tooltip("hide")},N=function(e,t){t.files&&t.files.error&&ew_Alert(t.files[0].error)},C=ew_GetForm(t),k=n(C),L=k.find("#a_confirm").val()=="F";L&&k.find("span.fileinput-button").hide();var A=parseInt(m.val(),10);r.fileupload({url:EW_UPLOAD_URL,autoUpload:!0,loadImageFileTypes:/^image\/(gif|jpe?g|png)$/i,acceptFileTypes:d.val()?new RegExp("\\.("+d.val().replace(/,/g,"|")+")$","i"):null,maxFileSize:parseInt(v.val(),10),maxNumberOfFiles:A>1?A:null,filesContainer:l,formData:{id:i,table:o,replace:u?"0":"1",exts:d.val(),maxsize:v.val(),maxfilecount:m.val()},uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:E,downloadTemplate:S,previewMaxWidth:EW_UPLOAD_THUMBNAIL_WIDTH,previewMaxHeight:EW_UPLOAD_THUMBNAIL_HEIGHT,dropZone:a,pasteZone:a,messages:{acceptFileTypes:ewLanguage.Phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:ewLanguage.Phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:ewLanguage.Phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:ewLanguage.Phrase("UploadErrMsgMinFileSize")}}).on("fileuploaddone",g).on("fileuploaddestroy",y).on("fileuploadchange",b).on("fileuploadadded fileuploadfinished fileuploaddestroyed",x).on("fileuploadprocessfail",N).click(T),c.val()&&n.ajax({url:EW_UPLOAD_URL,data:{id:i,table:o},dataType:"json",context:this,success:function(e){e&&e[i]&&r.fileupload("option","done").call(t,n.Event(),{result:{files:e[i]}}),L&&l.find("td.delete").hide()}})}function ew_ParseNumber(e,t){var n=jQuery;if(n.isString(e)){t=t||{thousandsSeparator:EW_THOUSANDS_SEP,decimalSeparator:EW_DECIMAL_POINT};var r=[],i,s=t.thousandsSeparator,o=t.decimalSeparator;s&&r.push(s.replace(/[\-$\^*()+\[\]{}|\\,.?\s]/g,"\\$&")+"(?=\\d)"),i=new RegExp("(?:"+r.join("|")+")","g"),o==="."&&(o=null),e=e.replace(i,""),e=o?e.replace(o,"."):e}n.isString(e)&&n.trim(e)!==""&&(e=+e);if(!n.isNumber||!isFinite(e))e=null;return e}function ew_FormatNumber(e,t){var n=jQuery;if(n.isNumber(e)){t=t||{thousandsSeparator:EW_THOUSANDS_SEP,decimalSeparator:EW_DECIMAL_POINT};var r=e<0,i=e+"",s=t.decimalPlaces,o=t.decimalSeparator||".",u=t.thousandsSeparator,a,f,l,c;n.isNumber(s)&&s>=0&&s<=20&&(i=e.toFixed(s)),o!=="."&&(i=i.replace(".",o));if(u){a=i.lastIndexOf(o),a=a>-1?a:i.length,f=i.substring(a);for(l=0,c=a;c>0;c--)l%3===0&&c!==a&&(!r||c>1)&&(f=u+f),f=i.charAt(c-1)+f,l++;i=f}return i}return n.isValue(e)&&e.toString?e.toString():""}function ew_ParseDate(e,t){var n=jQuery,r=n.makeArray(arguments);if(n.isNumber(t)&&t>=0&&t<=17){var i,s=EW_DEFAULT_DATE_FORMAT.toUpperCase(),o=EW_DATE_SEPARATOR;switch(t){case 0:case 2:case 8:i=s+" HH:mm:ss";break;case 1:i="dddd, MMMM DD, YYYY";break;case 3:i="hh:mm:ss A";break;case 4:i="HH:mm:ss";break;case 5:case 9:i="YYYY"+o+"MM"+o+"DD HH:mm:ss";break;case 6:case 10:i="MM"+o+"DD"+o+"YYYY HH:mm:ss";break;case 7:case 11:i="DD"+o+"MM"+o+"YYYY HH:mm:ss";break;case 12:case 15:i="YY"+o+"MM"+o+"DD HH:mm:ss";break;case 13:case 16:i="MM"+o+"DD"+o+"YY HH:mm:ss";break;case 14:case 17:i="DD"+o+"MM"+o+"YY HH:mm:ss"}r[1]=[i,"YYYY-MM-DD HH:mm:ss"]}return moment.apply(this,r)}function ew_FormatDate(e,t){return moment(e).format(t||EW_DEFAULT_DATE_FORMAT.toUpperCase())}var ewAddOptDialog,ewEmailDialog,$rowindex$=null,ewSearchDialog,EW_TABLE_CLASSNAME="ewTable",EW_GRID_CLASSNAME="ewGrid",EW_MULTI_COLUMN_GRID_CLASSNAME="ewMultiColumnGrid",EW_TABLE_ROW_CLASSNAME="ewTableRow",EW_TABLE_ALT_ROW_CLASSNAME="ewTableAltRow",EW_ITEM_TEMPLATE_CLASSNAME="ewTemplate",EW_ITEM_TABLE_CLASSNAME="ewItemTable",EW_TABLE_LAST_ROW_CLASSNAME="ewTableLastRow",EW_TABLE_LAST_COL_CLASSNAME="ewTableLastCol",EW_TABLE_PREVIEW_ROW_CLASSNAME="ewTablePreviewRow",EW_TABLE_EDIT_ROW_CLASSNAME="ewTableEditRow",EW_TABLE_SELECT_ROW_CLASSNAME="ewTableSelectRow",EW_TABLE_HIGHLIGHT_ROW_CLASSNAME="ewTableHighlightRow",EW_TABLE_BORDER_BOTTOM_CLASSNAME="ewTableBorderBottom",EW_REPORT_CONTAINER_ID="ewContainer",EW_ROWTYPE_ADD=2,EW_ROWTYPE_EDIT=3,EW_UNFORMAT_YEAR=50,ew_ClientScriptInclude=jQuery.getScript,ewLightboxSettings={transition:"none",photo:!0,opacity:.5};jQuery(document).on("addoption",ew_DefaultLookup),jQuery(function(e){e("input[data-toggle=tooltip],textarea[data-toggle=tooltip],select[data-toggle=tooltip]").each(function(){var t=e(this);t.tooltip(e.extend({html:!0,placement:"bottom"},t.data()))}),e("a.ewTooltipLink").each(ew_Tooltip),ew_InitPasswordOptions(),ew_SetSessionTimer(),e(".ewPopover").popover(),e(".ewTooltip").tooltip(),ew_InitIcons(),e.extend(ewLightboxSettings,{title:ewLanguage.Phrase("LightboxTitle"),current:ewLanguage.Phrase("LightboxCurrent"),previous:ewLanguage.Phrase("LightboxPrevious"),next:ewLanguage.Phrase("LightboxNext"),close:ewLanguage.Phrase("LightboxClose"),xhrError:ewLanguage.Phrase("LightboxXhrError"),imgError:ewLanguage.Phrase("LightboxImgError")}),e(".ewLightbox").each(function(){var t=e(this);t.colorbox(e.extend({rel:t.data("rel")},ewLightboxSettings))}),e("table."+EW_TABLE_CLASSNAME+":not(.ewExportTable):not(#"+EW_REPORT_CONTAINER_ID+" table)").each(ew_SetupTable),e("table."+EW_GRID_CLASSNAME+":not(.ewExportTable):not(#"+EW_REPORT_CONTAINER_ID+" table)").each(ew_SetupGrid),e(".ewButtonDropdown").on("shown.bs.dropdown",function(){var t=e(this).removeClass("dropup"),n=e(window);$menu=t.find("> .dropdown-menu"),t.toggleClass("dropup",$menu.offset().top+$menu.height()>n.scrollTop()+n.height())}),e.later(e("textarea.editor")[0]?250:0,null,function(){var t=e(window),n=e("#ewContentTable"),r=e("body").height();n.css("min-height",n.outerHeight()),t.resize(function(){t.height()>r&&n.css("height",t.height()-(e("#ewHeaderRow").is(":hidden")?0:e("#ewHeaderRow").height())-(e("#ewMobileMenu").is(":hidden")?0:e("#ewMobileMenu").height())-(e("#ewMenuRow").is(":hidden")?0:e("#ewMenuRow").height())-(e("#ewFooterRow").is(":hidden")?0:e("#ewFooterRow").height()))}).triggerHandler("resize")}),e("input[name=pageno]").keypress(function(e){if(e.which==13){var t=window.location.href,n=t.lastIndexOf(window.location.search);return window.location=t.substr(0,n)+"?"+this.name+"="+parseInt(this.value),!1}}),e(window).width()<768&&e(".table-responsive [data-toggle='dropdown']").parent().on("shown.bs.dropdown",function(){var t=e(this),n=t.find(".dropdown-menu"),r=t.closest(".table-responsive")[0];if(r.scrollHeight-r.clientHeight){var i=n.offset().top+n.outerHeight()-e(r).offset().top-r.clientHeight;i>0&&n.css(EW_CSS_FLIP?"right":"left","100%").css("top",parseFloat(n.css("top"))-i)}}),typeof EW_USE_JAVASCRIPT_MESSAGE!="undefined"&&EW_USE_JAVASCRIPT_MESSAGE&&ew_ShowMessage()});var ewForms=function(e){var t=jQuery.isString(e)?e:ew_GetForm(e).id;return arguments.callee[t]};jQuery.extend({isBoolean:function(e){return typeof e=="boolean"},isNull:function(e){return e===null},isNumber:function(e){return typeof e=="number"&&isFinite(e)},isObject:function(e){return e&&(typeof e=="object"||this.isFunction(e))||!1},isString:function(e){return typeof e=="string"},isUndefined:function(e){return typeof e=="undefined"},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isDate:function(e){return this.type(e)==="date"&&e.toString()!=="Invalid Date"&&!isNaN(e)},later:function(e,t,n,r,i){e=e||0,t=t||{};var s=n,o=r,u,a;this.isString(n)&&(s=t[n]);if(!s)return;return!this.isUndefined(r)&&!this.isArray(o)&&(o=[r]),u=function(){s.apply(t,o||[])},a=i?setInterval(u,e):setTimeout(u,e),{interval:i,cancel:function(){this.interval?clearInterval(a):clearTimeout(a)}}}}),jQuery.sub||(jQuery.sub=function(){function e(t,n){return new e.fn.init(t,n)}jQuery.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,i){var s=jQuery.fn.init.call(this,r,i,t);return s instanceof e?s:e(s)},e.fn.init.prototype=e.fn;var t=e(document);return e}),function(){var e=jQuery.sub();e.fn.extend({row:function(){var e=this.closest("#r_"+this.data("field").substr(2));return e[0]||(e=this.closest(".ewTable > tbody > tr")),e},visible:function(e){var t=this.closest("#r_"+this.data("field").substr(2));return t[0]||(t=this.closest("span[id^=el_]")),typeof e!="undefined"?(t.toggle(e),this):t.is(":visible")},readonly:function(e){return typeof e!="undefined"?(this.prop("readOnly",e),this):this.prop("readOnly")},disabled:function(e){return typeof e!="undefined"?(this.prop("disabled",e),this):this.prop("disabled")},value:function(e){var t=this.attr("type");if(typeof e!="undefined"){jQuery.isArray(e)||(e=[e]);var t=this.attr("type"),n=t=="radio"||t=="checkbox"?this.get():this[0];return ew_SelectOpt(n,e),this}return t=="checkbox"?ew_GetOptValues(this.get()):t=="radio"?ew_GetOptValues(this.get()).join():ew_IsHiddenTextArea(this)?(this.data("editor").save(),this.val()):this.val()},toNumber:function(){return ew_ParseNumber(this.value())},toDate:function(){return ew_ParseDate(this.value(),this.data("format"))},toJsDate:function(){return ew_ParseDate(this.value(),this.data("format")).toDate()}}),jQuery.fn.fields=function(t){var n=jQuery,r={},i=this.attr("id"),s=this[0],o,u,a;/^[xy](\d*)_/.test(i)?(o=ew_GetForm(s),u=this.data("table"),a=RegExp.$1):s&&s.Form&&(o=s.$Element,u=s.ID.replace(new RegExp("^f|"+s.PageID+"$","g"),""),a=n(s.Form).data("rowindex"));var f="[data-table="+u+"][data-field"+(t?"=x_"+t:"")+"]";return jQuery.isValue(a)&&(f+="[name^=x"+a+"_]"),o&&f&&n(o).find(f).each(function(){var t=this.getAttribute("data-field").substr(2),n=this.getAttribute("name");t=/^y_/.test(n)?"y_"+t:t,r[t]=r[t]?r[t].add(this):e(this)}),t?r[t]:r}}(),+function(e){"use strict";function i(r){if(r&&r.which===3)return;e(t).remove(),e(n,e(r.currentTarget).is(n)?e(r.currentTarget).parent():document).each(function(){var t=s(e(this)),n={relatedTarget:this};if(!t.hasClass("open"))return;t.trigger(r=e.Event("hide.bs.dropdown",n));if(r.isDefaultPrevented())return;t.removeClass("open").trigger("hidden.bs.dropdown",n)})}function s(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}var t=".dropdown-backdrop",n=".ewDropdown",r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.prototype.toggle=function(t){var n=e(this);if(n.is(".disabled, :disabled"))return;var r=s(n),o=r.hasClass("open");i(t);if(!o){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",i);var u={relatedTarget:this};r.trigger(t=e.Event("show.bs.dropdown",u));if(t.isDefaultPrevented())return;n.trigger("focus"),r.toggleClass("open").trigger("shown.bs.dropdown",u);var a=n.next();a.is("ul.dropdown-menu")&&a.find("> li > a").css("padding-left",parseInt(n.css("padding-left"),10)+10+"px")}return!1},r.prototype.keydown=function(t){if(!/(38|40|27)/.test(t.keyCode))return;var r=e(this);t.preventDefault(),t.stopPropagation();if(r.is(".disabled, :disabled"))return;var i=s(r),o=i.hasClass("open");if(!o||o&&t.keyCode==27)return t.which==27&&i.find(n).trigger("focus"),r.trigger("click");var u=" li:not(.divider):visible a",a=i.find('[role="menu"]'+u+', [role="listbox"]'+u);if(!a.length)return;var f=a.index(a.filter(":focus"));t.keyCode==38&&f>0&&f--,t.keyCode==40&&f<a.length-1&&f++,~f||(f=0),a.eq(f).trigger("focus")};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})},e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n+', [role="menu"], [role="listbox"]',r.prototype.keydown)}(jQuery),function(e){e.fn.drag=function(e,t,n){var r=typeof e=="string"?e:"",i=jQuery.isFunction(e)?e:jQuery.isFunction(t)?t:null;return r.indexOf("drag")!==0&&(r="drag"+r),n=(e==i?t:n)||{},i?this.bind(r,n,i):this.trigger(r)};var t=e.event,n=t.special,r=n.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var n=e.data(this,r.datakey),i=t.data||{};n.related+=1,e.each(r.defaults,function(e,t){i[e]!==undefined&&(n[e]=i[e])})},remove:function(){e.data(this,r.datakey).related-=1},setup:function(){if(e.data(this,r.datakey))return;var n=e.extend({related:0},r.defaults);e.data(this,r.datakey,n),t.add(this,"touchstart mousedown",r.init,n),this.attachEvent&&this.attachEvent("ondragstart",r.dontstart)},teardown:function(){var n=e.data(this,r.datakey)||{};if(n.related)return;e.removeData(this,r.datakey),t.remove(this,"touchstart mousedown",r.init),r.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",r.dontstart)},init:function(i){if(r.touched)return;var s=i.data,o;if(i.which!=0&&s.which>0&&i.which!=s.which)return;if(e(i.target).is(s.not))return;if(s.handle&&!e(i.target).closest(s.handle,i.currentTarget).length)return;r.touched=i.type=="touchstart"?this:null,s.propagates=1,s.mousedown=this,s.interactions=[r.interaction(this,s)],s.target=i.target,s.pageX=i.pageX,s.pageY=i.pageY,s.dragging=null,o=r.hijack(i,"draginit",s);if(!s.propagates)return;o=r.flatten(o),o&&o.length&&(s.interactions=[],e.each(o,function(){s.interactions.push(r.interaction(this,s))})),s.propagates=s.interactions.length,s.drop!==!1&&n.drop&&n.drop.handler(i,s),r.textselect(!1),r.touched?t.add(r.touched,"touchmove touchend",r.handler,s):t.add(document,"mousemove mouseup",r.handler,s);if(!r.touched||s.live)return!1},interaction:function(t,n){var i=e(t)[n.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new r.callback,droppable:[],offset:i}},handler:function(i){var s=i.data;switch(i.type){case!s.dragging&&"touchmove":i.preventDefault();case!s.dragging&&"mousemove":if(Math.pow(i.pageX-s.pageX,2)+Math.pow(i.pageY-s.pageY,2)<Math.pow(s.distance,2))break;i.target=s.target,r.hijack(i,"dragstart",s),s.propagates&&(s.dragging=!0);case"touchmove":i.preventDefault();case"mousemove":if(s.dragging){r.hijack(i,"drag",s);if(s.propagates){s.drop!==!1&&n.drop&&n.drop.handler(i,s);break}i.type="mouseup"};case"touchend":case"mouseup":default:r.touched?t.remove(r.touched,"touchmove touchend",r.handler):t.remove(document,"mousemove mouseup",r.handler),s.dragging&&(s.drop!==!1&&n.drop&&n.drop.handler(i,s),r.hijack(i,"dragend",s)),r.textselect(!0),s.click===!1&&s.dragging&&e.data(s.mousedown,"suppress.click",(new Date).getTime()+5),s.dragging=r.touched=!1}},hijack:function(n,i,s,o,u){if(!s)return;var a={event:n.originalEvent,type:n.type},f=i.indexOf("drop")?"drag":"drop",l,c=o||0,h,p,d,v=isNaN(o)?s.interactions.length:o;n.type=i,n.originalEvent=null,s.results=[];do if(h=s.interactions[c]){if(i!=="dragend"&&h.cancelled)continue;d=r.properties(n,s,h),h.results=[],e(u||h[f]||s.droppable).each(function(o,u){d.target=u,n.isPropagationStopped=function(){return!1},l=u?t.dispatch.call(u,n,d):null,l===!1?(f=="drag"&&(h.cancelled=!0,s.propagates-=1),i=="drop"&&(h[f][o]=null)):i=="dropinit"&&h.droppable.push(r.element(l)||u),i=="dragstart"&&(h.proxy=e(r.element(l)||h.drag)[0]),h.results.push(l),delete n.result;if(i!=="dropinit")return l}),s.results[c]=r.flatten(h.results),i=="dropinit"&&(h.droppable=r.flatten(h.droppable)),i=="dragstart"&&!h.cancelled&&d.update()}while(++c<v);return n.type=a.type,n.originalEvent=a.event,r.flatten(s.results)},properties:function(e,t,n){var i=n.callback;return i.drag=n.drag,i.proxy=n.proxy||n.drag,i.startX=t.pageX,i.startY=t.pageY,i.deltaX=e.pageX-t.pageX,i.deltaY=e.pageY-t.pageY,i.originalX=n.offset.left,i.originalY=n.offset.top,i.offsetX=i.originalX+i.deltaX,i.offsetY=i.originalY+i.deltaY,i.drop=r.flatten((n.drop||[]).slice()),i.available=r.flatten((n.droppable||[]).slice()),i},element:function(e){if(e&&(e.jquery||e.nodeType==1))return e},flatten:function(t){return e.map(t,function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?r.flatten(t):t})},textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart",r.dontstart).css("MozUserSelect",t?"":"none"),document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};r.callback.prototype={update:function(){n.drop&&this.available.length&&e.each(this.available,function(e){n.drop.locate(this,e)})}};var i=t.dispatch;t.dispatch=function(t){if(e.data(this,"suppress."+t.type)-(new Date).getTime()>0){e.removeData(this,"suppress."+t.type);return}return i.apply(this,arguments)};var s=t.fixHooks.touchstart=t.fixHooks.touchmove=t.fixHooks.touchend=t.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(t,n){if(n){var r=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0]||null;r&&e.each(s.props,function(e,n){t[n]=r[n]})}return t}};n.draginit=n.dragstart=n.dragend=r}(jQuery);